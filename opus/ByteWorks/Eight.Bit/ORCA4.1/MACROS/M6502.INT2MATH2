******************************************************************  M6502.INT2MATH2**  Two byte integer mathematics (continued).**  By Mike Westerfield*  Copyright (C) December 1984, All rights reserved*  By the Byte Works, Inc.*****************************************************************         MACRO&LAB     MUL2  &N1,&N2,&N3         LCLC  &C         LCLC  &C1         LCLC  &C2         LCLC  &C3         LCLC  &B1         LCLC  &B2         LCLC  &B3         LCLB  &ST1         AIF   "&N1"<>"*",.A&B1      SETC  011&ST1     SETB  1&C1      SETC  ANOP         AGO   .E.A&C       AMID  &N1,1,1         AIF   "&C"<>"#",.B&B1      SETC  000&N1      AMID  &N1,2,L:&N1-1         AGO   .D.B         AIF   "&C"<>"{",.C&C       AMID  &N1,L:&N1,1         AIF   "&C"<>"}",.P&N1      AMID  &N1,2,L:&N1-2&B1      SETC  010         AGO   .D.C&B1      SETC  001.D&C1      SETC  "DC I'&N1'".E         AIF   "&N2"<>"*",.F&B2      SETC  011&C2      SETC  ANOP         AGO   .J.F&C       AMID  &N2,1,1         AIF   "&C"<>"#",.G&B2      SETC  000&N2      AMID  &N2,2,L:&N2-1         AGO   .I.G         AIF   "&C"<>"{",.H&C       AMID  &N2,L:&N2,1         AIF   "&C"<>"}",.P&N2      AMID  &N2,2,L:&N2-2&B2      SETC  010         AGO   .I.H&B2      SETC  001.I&C2      SETC  "DC I'&N2'".J         AIF   C:&N3>0,.K&B3      SETC  &B1         AIF   &ST1,.J1&C3      SETC  "DC I'&N1'"         AGO   .O.J1&C3      SETC  ANOP         AGO   .O.K         AIF   "&N3"<>"*",.L&B3      SETC  011&C3      SETC  ANOP         AGO   .O.L&C       AMID  &N3,1,1         AIF   "&C"<>"{",.M&C       AMID  &N3,L:&N3,1         AIF   "&C"<>"}",.P&N3      AMID  &N3,2,L:&N3-2&B3      SETC  010         AGO   .N.M&B3      SETC  001.N&C3      SETC  "DC I'&N3'".O&LAB     JSR   SYSBOPR         DC    A"SYSMUL2"         DC    B"000 &B1 000 &B2 &B3"         &C1         &C2         &C3         MEXIT.P         MNOTE "Missing closing '}'",16         MEND         MACRO&LAB     RAN2  &N1         LCLC  &C         LCLC  &C1         LCLC  &B1         AIF   "&N1"<>"*",.A&B1      SETC  011&C1      SETC  ANOP         AGO   .E.A&C       AMID  &N1,1,1         AIF   "&C"<>"{",.C&C       AMID  &N1,L:&N1,1         AIF   "&C"<>"}",.K&N1      AMID  &N1,2,L:&N1-2&B1      SETC  010         AGO   .D.C&B1      SETC  001.D&C1      SETC  "DC I'&N1'".E&LAB     JSR   SYSBOPR+12         DC    A"SYSRANI"         DC    B"000 &B1"         DS    1         &C1         MEXIT.K         MNOTE "Missing closing '}'",16         MEND         MACRO&LAB     SIGN2 &N1,&N2         LCLC  &C         LCLC  &C1         LCLC  &C2         LCLC  &B1         LCLC  &B2         LCLB  &ST1         AIF   "&N1"<>"*",.A&B1      SETC  011&ST1     SETB  1&C1      SETC  ANOP         AGO   .E.A&C       AMID  &N1,1,1         AIF   "&C"<>"#",.B&B1      SETC  000&N1      AMID  &N1,2,L:&N1-1         AGO   .D.B         AIF   "&C"<>"{",.C&C       AMID  &N1,L:&N1,1         AIF   "&C"<>"}",.K&N1      AMID  &N1,2,L:&N1-2&B1      SETC  010         AGO   .D.C&B1      SETC  001.D&C1      SETC  "DC I'&N1'".E         AIF   C:&N2>0,.F&B2      SETC  &B1         AIF   &ST1,.E1&C2      SETC  "DC I'&N1'"         AGO   .J.E1&C2      SETC  ANOP         AGO   .J.F         AIF   "&N2"<>"*",.G&B2      SETC  011&C2      SETC  ANOP         AGO   .J.G&C       AMID  &N2,1,1         AIF   "&C"<>"{",.H&C       AMID  &N2,L:&N2,1         AIF   "&C"<>"}",.K&N2      AMID  &N2,2,L:&N2-2&B2      SETC  010         AGO   .I.H&B2      SETC  001.I&C2      SETC  "DC I'&N2'".J&LAB     JSR   SYSBOPR+8         DC    A"SYSSGN2"         DC    B"000 &B1 000 &B2"         &C1         &C2         MEXIT.K         MNOTE "Missing closing '}'",16         MEND         MACRO&LAB     SQRT2 &N1,&N2         LCLC  &C         LCLC  &C1         LCLC  &C2         LCLC  &B1         LCLC  &B2         LCLB  &ST1         AIF   "&N1"<>"*",.A&B1      SETC  011&ST1     SETB  1&C1      SETC  ANOP         AGO   .E.A&C       AMID  &N1,1,1         AIF   "&C"<>"#",.B&B1      SETC  000&N1      AMID  &N1,2,L:&N1-1         AGO   .D.B         AIF   "&C"<>"{",.C&C       AMID  &N1,L:&N1,1         AIF   "&C"<>"}",.K&N1      AMID  &N1,2,L:&N1-2&B1      SETC  010         AGO   .D.C&B1      SETC  001.D&C1      SETC  "DC I'&N1'".E         AIF   C:&N2>0,.F&B2      SETC  &B1         AIF   &ST1,.E1&C2      SETC  "DC I'&N1'"         AGO   .J.E1&C2      SETC  ANOP         AGO   .J.F         AIF   "&N2"<>"*",.G&B2      SETC  011&C2      SETC  ANOP         AGO   .J.G&C       AMID  &N2,1,1         AIF   "&C"<>"{",.H&C       AMID  &N2,L:&N2,1         AIF   "&C"<>"}",.K&N2      AMID  &N2,2,L:&N2-2&B2      SETC  010         AGO   .I.H&B2      SETC  001.I&C2      SETC  "DC I'&N2'".J&LAB     JSR   SYSBOPR+8         DC    A"SYSSQR2"         DC    B"000 &B1 000 &B2"         &C1         &C2         MEXIT.K         MNOTE "Missing closing '}'",16         MEND         MACRO&LAB     SUB2  &N1,&N2,&N3&LAB     ANOP         AIF   C:SYSESTE>0,.XXSYSESTE  EQU   $98.XX         LCLB  &IM1         LCLB  &IM2         LCLB  &IN1         LCLB  &IN2         LCLB  &IN3         LCLB  &IN         LCLB  &ST1         LCLB  &ST2         LCLB  &ST3         LCLC  &C         LCLC  &N12         LCLC  &N22         LCLC  &N32         AIF   "&N1"<>"*",.A&IN1     SETB  1&IN      SETB  1&ST1     SETB  1&N1      SETC  "(SYSESTE),Y"&N12     SETC  "(SYSESTE),Y"         AGO   .D.A&C       AMID  &N1,1,1         AIF   "&C"<>"#",.B&IM1     SETB  1&N12     AMID  &N1,2,L:&N1-1&N12     SETC  #>&N12         AGO   .D.B         AIF   "&C"<>"{",.C&IN1     SETB  1&IN      SETB  1&C       AMID  &N1,L:&N1,1         AIF   "&C"<>"}",.Y&N1      AMID  &N1,2,L:&N1-2&N12     SETC  "(&N1),Y"&N1      SETC  "(&N1),Y"         AGO   .D.C&N12     SETC  &N1+1.D         AIF   "&N2"<>"*",.E&IN2     SETB  1&IN      SETB  1&ST2     SETB  1&N2      SETC  "(SYSESTE),Y"&N22     SETC  "(SYSESTE),Y"         AGO   .H.E&C       AMID  &N2,1,1         AIF   "&C"<>"#",.F&IM2     SETB  1&N22     AMID  &N2,2,L:&N2-1&N22     SETC  #>&N22         AGO   .H.F         AIF   "&C"<>"{",.G&IN2     SETB  1&IN      SETB  1&C       AMID  &N2,L:&N2,1         AIF   "&C"<>"}",.Y&N2      AMID  &N2,2,L:&N2-2&N22     SETC  "(&N2),Y"&N2      SETC  "(&N2),Y"         AGO   .H.G&N22     SETC  &N2+1.H         AIF   C:&N3>0,.I         AIF   .NOT.&IM2..OR.&IN,.H1&C       AMID  &N2,2,L:&N2-1         AIF   &C<256,.V.H1         LCLC  &N3&N3      SETC  "&N1"&N32     SETC  "&N12"&IN3     SETB  &IN1&ST3     SETB  &ST1         AIF   .NOT.&IM1,.L         MNOTE "Must specify destination",16         MEXIT.I         AIF   "&N3"<>"*",.J&IN3     SETB  1&IN      SETB  1&ST3     SETB  1&N3      SETC  "(SYSESTE),Y"&N32     SETC  "(SYSESTE),Y"         AGO   .L.J&C       AMID  &N3,1,1         AIF   "&C"<>"{",.K&IN3     SETB  1&IN      SETB  1&C       AMID  &N3,L:&N3,1         AIF   "&C"<>"}",.Y&N3      AMID  &N3,2,L:&N3-2&N32     SETC  "(&N3),Y"&N3      SETC  "(&N3),Y"         AGO   .L.K&N32     SETC  &N3+1.L         AIF   &ST1..AND.&ST2,.Q         AIF   &ST1+&ST2>=&ST3,.M         SEC         LDA   SYSESTE         SBC   #2         STA   SYSESTE         BCS   SYSA&SYSCNT         DEC   SYSESTE+1SYSA&SYSCNT ANOP.M         SEC         AIF   .NOT.&IN,.N         LDY   #0.N         LDA   &N1         SBC   &N2         STA   &N3         AIF   .NOT.&IN,.O         INY.O         LDA   &N12         SBC   &N22         STA   &N32         AIF   &ST1+&ST2<=&ST3,.P         CLC         LDA   SYSESTE         ADC   #2         STA   SYSESTE         BCC   SYSB&SYSCNT         INC   SYSESTE+1SYSB&SYSCNT ANOP.P         MEXIT.Q         AIF   .NOT.&ST3,.R         SEC         LDY   #2         LDA   &N1         LDY   #0         SBC   &N2         LDY   #2         STA   &N3         INY         LDA   &N12         LDY   #1         SBC   &N22         LDY   #3         STA   &N32         AGO   .S.R         SEC         LDY   #2         LDA   &N1         LDY   #0         SBC   &N2         STA   &N3         LDY   #3         LDA   &N12         LDY   #1         SBC   &N22         STA   &N32.S         CLC         LDA   SYSESTE         AIF   &ST3,.T         ADC   #4         AGO   .U.T         ADC   #2.U         STA   SYSESTE         BCC   SYSC&SYSCNT         INC   SYSESTE+1SYSC&SYSCNT ANOP         MEXIT.V         SEC         AIF   .NOT.&IN,.W         LDY   #0.W         LDA   &N1         SBC   &N2         STA   &N1         BCS   SYSD&SYSCNT         AIF   .NOT.&IN,.X         INY.X         DEC   &N1+1SYSD&SYSCNT ANOP         MEXIT.Y         MNOTE "Missing closing '}'",16         MEND