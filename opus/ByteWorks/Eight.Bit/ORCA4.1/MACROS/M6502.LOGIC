******************************************************************  M6502.LOGIC**  Two byte operations and logic macros.**  By Mike Westerfield*  Copyright (C) December 1984, All rights reserved*  By the Byte Works, Inc.*****************************************************************         MACRO&LAB     ASL2  &N1         AIF   C:SYSESTE>0,.XXSYSESTE  EQU   $98.XX         LCLC  &C         LCLC  &C1         LCLC  &B1         AIF   "&N1"<>"*",.A&N1      SETC  SYSESTE         AGO   .A1.A&C       AMID  &N1,1,1         AIF   "&C"<>"{",.B&C       AMID  &N1,L:&N1,1         AIF   "&C"<>"}",.C&N1      AMID  &N1,2,L:&N1-2.A1&LAB     LDY   #0         LDA   (&N1),Y         ASL   A         STA   (&N1),Y         INY         LDA   (&N1),Y         ROL   A         STA   (&N1),Y         MEXIT.B&LAB     ASL   &N1         ROL   &N1+1         MEXIT.C         MNOTE "Missing closing '}'",16         MEND         MACRO&LAB     BGT   &BP&LAB     BEQ   *+4         BGE   &BP         MEND         MACRO&LAB     BLE   &BP&LAB     BLT   &BP         BEQ   &BP         MEND         MACRO&LAB     CMPW  &N1,&N2&LAB     ANOP         AIF   C:SYSESTE>0,.XXSYSESTE  EQU   $98.XX         LCLB  &IM1         LCLB  &IM2         LCLB  &IN1         LCLB  &IN2         LCLB  &IN         LCLB  &ST1         LCLB  &ST2         LCLC  &C         LCLC  &N12         LCLC  &N22         AIF   "&N1"<>"*",.A&IN1     SETB  1&IN      SETB  1&ST1     SETB  1&N1      SETC  "(SYSESTE),Y"&N12     SETC  "(SYSESTE),Y"         AGO   .D.A&C       AMID  &N1,1,1         AIF   "&C"<>"#",.B&IM1     SETB  1&N12     AMID  &N1,2,L:&N1-1&N12     SETC  #>&N12         AGO   .D.B         AIF   "&C"<>"{",.C&IN1     SETB  1&IN      SETB  1&C       AMID  &N1,L:&N1,1         AIF   "&C"<>"}",.Y&N1      AMID  &N1,2,L:&N1-2&N12     SETC  "(&N1),Y"&N1      SETC  "(&N1),Y"         AGO   .D.C&N12     SETC  &N1+1.D         AIF   "&N2"<>"*",.E&IN2     SETB  1&IN      SETB  1&ST2     SETB  1&N2      SETC  "(SYSESTE),Y"&N22     SETC  "(SYSESTE),Y"         AGO   .H.E&C       AMID  &N2,1,1         AIF   "&C"<>"#",.F&IM2     SETB  1&N22     AMID  &N2,2,L:&N2-1&N22     SETC  #>&N22         AGO   .H.F         AIF   "&C"<>"{",.G&IN2     SETB  1&IN      SETB  1&C       AMID  &N2,L:&N2,1         AIF   "&C"<>"}",.Y&N2      AMID  &N2,2,L:&N2-2&N22     SETC  "(&N2),Y"&N2      SETC  "(&N2),Y"         AGO   .H.G&N22     SETC  &N2+1.H         AIF   .NOT.&IM2,.I&C       AMID  &N2,2,L:&N2-1         AIF   &C=0,.V.I         AIF   &ST1..AND.&ST2,.Q         AIF   .NOT.&IN,.N         LDY   #1.N         LDA   &N12         CMP   &N22         BNE   SYSA&SYSCNT         AIF   .NOT.&IN,.O         DEY.O         LDA   &N1         CMP   &N2SYSA&SYSCNT ANOP         AIF   .NOT.(&ST1..OR.&ST2),.P         PHP         CLC         LDA   SYSESTE         ADC   #2         STA   SYSESTE         BCC   SYSB&SYSCNT         INC   SYSESTE+1SYSB&SYSCNT PLP.P         MEXIT.Q         LDY   #3         LDA   &N12         LDY   #1         CMP   &N22         BNE   SYSB&SYSCNT         LDY   #2         LDA   &N1         LDY   #0         CMP   &N2SYSB&SYSCNT ANOP         PHP         CLC         LDA   SYSESTE         ADC   #4         STA   SYSESTE         BCC   SYSC&SYSCNT         INC   SYSESTE+1SYSC&SYSCNT PLP         MEXIT.V         SEC         AIF   .NOT.&IN,.W         LDY   #0.W         LDA   &N1         AIF   .NOT.&IN,.X         INY.X         ORA   &N12         AIF   .NOT.&ST1,.X1         PHP         CLC         LDA   SYSESTE         ADC   #2         STA   SYSESTE         BCC   SYSC&SYSCNT         INC   SYSESTE+1SYSC&SYSCNT PLP.X1         MEXIT.Y         MNOTE "Missing closing '}'",16         MEND         MACRO&LAB     DBEQ  &R,&BP         AIF   "&R"="X",.L1         AIF   "&R"="Y",.L1&LAB     DEC   &R         BEQ   &BP         MEXIT.L1&LAB     DE&R         BEQ   &BP         MEND         MACRO&LAB     DBNE  &R,&BP         AIF   "&R"="X",.L1         AIF   "&R"="Y",.L1&LAB     DEC   &R         BNE   &BP         MEXIT.L1&LAB     DE&R         BNE   &BP         MEND         MACRO&LAB     DBNE2 &ADR,&BP&LAB     LDA   &ADR         BNE   SYSA&SYSCNT         DEC   &ADR+1SYSA&SYSCNT DEC &ADR         LDA   &ADR         ORA   &ADR+1         BNE   &BP         MEND         MACRO&LAB     DBPL  &R,&BP         AIF   "&R"="X",.L1         AIF   "&R"="Y",.L1&LAB     DEC   &R         BPL   &BP         MEXIT.L1&LAB     DE&R         BPL   &BP         MEND         MACRO&LAB     DBPL2 &ADR,&BP&LAB     LDA   &ADR         BNE   SYSA&SYSCNT         DEC   &ADR+1SYSA&SYSCNT DEC &ADR         LDA   &ADR+1         BPL   &BP         MEND         MACRO&LAB     DEC2  &N1         LCLC  &C         LCLC  &C1         LCLC  &B1         AIF   "&N1"<>"*",.A&N1      SETC  SYSESTE         AGO   .A1.A&C       AMID  &N1,1,1         AIF   "&C"<>"{",.B&C       AMID  &N1,L:&N1,1         AIF   "&C"<>"}",.C&N1      AMID  &N1,2,L:&N1-2.A1&LAB     LDY   #0         SEC         LDA   (&N1),Y         SBC   #1         STA   (&N1),Y         INY         LDA   (&N1),Y         SBC   #0         STA   (&N1),Y         MEXIT.B&LAB     LDA   &N1         BNE   SYSI&SYSCNT         DEC   &N1+1SYSI&SYSCNT DEC &N1         MEXIT.C         MNOTE "Missing closing '}'",16         MEND         MACRO&LAB     INC2  &N1         LCLC  &C         LCLC  &C1         LCLC  &B1         AIF   "&N1"<>"*",.A&N1      SETC  SYSESTE         AGO   .A1.A&C       AMID  &N1,1,1         AIF   "&C"<>"{",.B&C       AMID  &N1,L:&N1,1         AIF   "&C"<>"}",.C&N1      AMID  &N1,2,L:&N1-2.A1&LAB     LDY   #0         CLC         LDA   (&N1),Y         ADC   #1         STA   (&N1),Y         INY         LDA   (&N1),Y         ADC   #0         STA   (&N1),Y         MEXIT.B&LAB     INC   &N1         BNE   SYSI&SYSCNT         INC   &N1+1SYSI&SYSCNT ANOP         MEXIT.C         MNOTE "Missing closing '}'",16         MEND         MACRO&LAB     JCC   &BP&LAB     BCS   *+5         JMP   &BP         MEND         MACRO&LAB     JCS   &BP&LAB     BCC   *+5         JMP   &BP         MEND         MACRO&LAB     JEQ   &BP&LAB     BNE   *+5         JMP   &BP         MEND         MACRO&LAB     JGE   &BP&LAB     BLT   *+5         JMP   &BP         MEND         MACRO&LAB     JGT   &BP&LAB     BEQ   *+7         BLT   *+5         JMP   &BP         MEND         MACRO&LAB     JLE   &BP&LAB     BEQ   *+4         BGE   *+5         JMP   &BP         MEND         MACRO&LAB     JLT   &BP&LAB     BGE   *+5         JMP   &BP         MEND         MACRO&LAB     JMI   &BP&LAB     BPL   *+5         JMP   &BP         MEND         MACRO&LAB     JNE   &BP&LAB     BEQ   *+5         JMP   &BP         MEND         MACRO&LAB     JPL   &BP&LAB     BMI   *+5         JMP   &BP         MEND         MACRO&LAB     LSR2  &N1         AIF   C:SYSESTE>0,.XXSYSESTE  EQU   $98.XX         LCLC  &C         LCLC  &C1         LCLC  &B1         AIF   "&N1"<>"*",.A&N1      SETC  SYSESTE         AGO   .A1.A&C       AMID  &N1,1,1         AIF   "&C"<>"{",.B&C       AMID  &N1,L:&N1,1         AIF   "&C"<>"}",.C&N1      AMID  &N1,2,L:&N1-2.A1&LAB     LDY   #1         LDA   (&N1),Y         LSR   A         STA   (&N1),Y         DEY         LDA   (&N1),Y         ROR   A         STA   (&N1),Y         MEXIT.B&LAB     LSR   &N1+1         ROR   &N1         MEXIT.C         MNOTE "Missing closing '}'",16         MEND         MACRO&LAB     MASL  &ADR,&NUM&LAB     ANOP         LCLA  &NM&NM      SETA  &NUM.TOP         ASL   &ADR&NM      SETA  &NM-1         AIF   &NM>0,.TOP         MEND         MACRO&LAB     MLSR  &ADR,&NUM&LAB     ANOP         LCLA  &NM&NM      SETA  &NUM.TOP         LSR   &ADR&NM      SETA  &NM-1         AIF   &NM>0,.TOP         MEND