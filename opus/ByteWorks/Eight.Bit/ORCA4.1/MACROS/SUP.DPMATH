******************************************************************  M6502.DPMATH**  Double precision floating point mathematics.**  By Mike Westerfield*  Copyright (C) August 1984, All rights reserved*  By the Byte Works, Inc.*****************************************************************         MACRO&LAB     ABSD  &N1,&N2         AIF   C:&N2>0,.A         LCLC  &N2.A&LAB     DUOP  &N1,&N2,SYSABSF         MEND         MACRO&LAB     ADDD  &N1,&N2,&N3         DC    R'SYSSUBD'         AIF   C:&N3>0,.A         LCLC  &N3.A&LAB     DBOP  &N1,&N2,&N3,SYSADDD         MEND         MACRO&LAB     ATAND &N1,&N2         AIF   C:&N2>0,.A         LCLC  &N2.A&LAB     DUOP  &N1,&N2,SYSATND         MEND         MACRO&LAB     CHSD  &N1,&N2         AIF   C:&N2>0,.A         LCLC  &N2.A&LAB     DUOP  &N1,&N2,SYSCHSF         MEND         MACRO&LAB     CMPD  &N1,&N2         LCLC  &C         LCLC  &C1         LCLC  &C2         LCLC  &B1         LCLC  &B2         AIF   '&N1'<>'*',.A&B1      SETC  011&C1      SETC  ANOP         AGO   .E.A&C       AMID  &N1,1,1         AIF   '&C'<>'#',.B&B1      SETC  000&N1      AMID  &N1,2,L:&N1-1&C1      SETC  'DC D''&N1'''         AGO   .E.B         AIF   '&C'<>'{',.C&C       AMID  &N1,L:&N1,1         AIF   '&C'<>'}',.K&N1      AMID  &N1,2,L:&N1-2&B1      SETC  010         AGO   .D.C&B1      SETC  001.D&C1      SETC  'DC I''&N1'''.E         AIF   '&N2'<>'*',.F&B2      SETC  011&C2      SETC  ANOP         AGO   .J.F&C       AMID  &N2,1,1         AIF   '&C'<>'#',.G&B2      SETC  000&N2      AMID  &N2,2,L:&N2-1&C2      SETC  'DC D''&N2'''         AGO   .J.G         AIF   '&C'<>'{',.H&C       AMID  &N2,L:&N2,1         AIF   '&C'<>'}',.K&N2      AMID  &N2,2,L:&N2-2&B2      SETC  010         AGO   .I.H&B2      SETC  001.I&C2      SETC  'DC I''&N2'''.J&LAB     JSR   SYSBOPR+4         DC    A'SYSCMPD'         DC    B'101 &B1 101 &B2'         &C1         &C2         DC    R'SYSUNPD'         DC    R'SYSPAKD'         MEXIT.K         MNOTE 'Missing closing ''}''',16         MEND         MACRO&LAB     COSD  &N1,&N2         AIF   C:&N2>0,.A         LCLC  &N2.A&LAB     DUOP  &N1,&N2,SYSCOSD         MEND         MACRO&LAB     DIVD  &N1,&N2,&N3         AIF   C:&N3>0,.A         LCLC  &N3.A&LAB     DBOP  &N1,&N2,&N3,SYSDIVD         MEND         MACRO&LAB     EXPD  &N1,&N2         AIF   C:&N2>0,.A         LCLC  &N2.A&LAB     DUOP  &N1,&N2,SYSEXPD         MEND         MACRO&LAB     INTD  &N1,&N2         AIF   C:&N2>0,.A         LCLC  &N2.A&LAB     DUOP  &N1,&N2,SYSINTD         MEND         MACRO&LAB     LND   &N1,&N2         AIF   C:&N2>0,.A         LCLC  &N2.A&LAB     DUOP  &N1,&N2,SYSLNXD         DC    R'SYSCV2F'         MEND         MACRO&LAB     MULD  &N1,&N2,&N3         AIF   C:&N3>0,.A         LCLC  &N3.A&LAB     DBOP  &N1,&N2,&N3,SYSMULD         MEND         MACRO&LAB     PWRD  &N1,&N2,&N3         AIF   C:&N3>0,.A         LCLC  &N3.A&LAB     DBOP  &N1,&N2,&N3,SYSPWRD         DC    R'SYSCV2F'         MEND         MACRO&LAB     RAND  &N1         LCLC  &C         LCLC  &C1         LCLC  &B1         AIF   '&N1'<>'*',.A&B1      SETC  011&C1      SETC  ANOP         AGO   .E.A&C       AMID  &N1,1,1         AIF   '&C'<>'{',.C&C       AMID  &N1,L:&N1,1         AIF   '&C'<>'}',.K&N1      AMID  &N1,2,L:&N1-2&B1      SETC  010         AGO   .D.C&B1      SETC  001.D&C1      SETC  'DC I''&N1'''.E&LAB     JSR   SYSBOPR+12         DC    A'SYSRAND'         DC    B'101 &B1'         DS    1         &C1         DC    R'SYSUNPD'         DC    R'SYSPAKD'         DC    R'SYSRANX'         MEXIT.K         MNOTE 'Missing closing ''}''',16         MEND         MACRO&LAB     SIGND &N1,&N2         AIF   C:&N2>0,.A         LCLC  &N2.A&LAB     DUOP  &N1,&N2,SYSSGND         MEND         MACRO&LAB     SIND  &N1,&N2         DC    R'SYSCOSD'         AIF   C:&N2>0,.A         LCLC  &N2.A&LAB     DUOP  &N1,&N2,SYSSIND         MEND         MACRO&LAB     SQRTD &N1,&N2         AIF   C:&N2>0,.A         LCLC  &N2.A&LAB     DUOP  &N1,&N2,SYSSQRD         MEND         MACRO&LAB     SUBD  &N1,&N2,&N3         AIF   C:&N3>0,.A         LCLC  &N3.A&LAB     DBOP  &N1,&N2,&N3,SYSSUBD         MEND         MACRO&LAB     TAND  &N1,&N2         AIF   C:&N2>0,.A         LCLC  &N2.A&LAB     DUOP  &N1,&N2,SYSTAND         MEND         MACRO&LAB     DUOP  &N1,&N2,&SUB         LCLC  &C         LCLC  &C1         LCLC  &C2         LCLC  &B1         LCLC  &B2         LCLB  &ST1         AIF   '&N1'<>'*',.A&B1      SETC  011&ST1     SETB  1&C1      SETC  ANOP         AGO   .E.A&C       AMID  &N1,1,1         AIF   '&C'<>'#',.B&B1      SETC  000&N1      AMID  &N1,2,L:&N1-1&C1      SETC  'DC D''&N1'''         AGO   .E.B         AIF   '&C'<>'{',.C&C       AMID  &N1,L:&N1,1         AIF   '&C'<>'}',.K&N1      AMID  &N1,2,L:&N1-2&B1      SETC  010         AGO   .D.C&B1      SETC  001.D&C1      SETC  'DC I''&N1'''.E         AIF   C:&N2>0,.F&B2      SETC  &B1         AIF   &ST1,.E1&C2      SETC  'DC I''&N1'''         AGO   .J.E1&C2      SETC  ANOP         AGO   .J.F         AIF   '&N2'<>'*',.G&B2      SETC  011&C2      SETC  ANOP         AGO   .J.G&C       AMID  &N2,1,1         AIF   '&C'<>'{',.H&C       AMID  &N2,L:&N2,1         AIF   '&C'<>'}',.K&N2      AMID  &N2,2,L:&N2-2&B2      SETC  010         AGO   .I.H&B2      SETC  001.I&C2      SETC  'DC I''&N2'''.J&LAB     JSR   SYSBOPR+8         DC    A'&SUB'         DC    B'101 &B1 101 &B2'         &C1         &C2         DC    R'SYSUNPD'         DC    R'SYSPAKD'         MEXIT.K         MNOTE 'Missing closing ''}''',16         MEND         MACRO&LAB     DBOP  &N1,&N2,&N3,&SUB         LCLC  &C         LCLC  &C1         LCLC  &C2         LCLC  &C3         LCLC  &B1         LCLC  &B2         LCLC  &B3         LCLB  &ST1         AIF   '&N1'<>'*',.A&B1      SETC  011&ST1     SETB  1&C1      SETC  ANOP         AGO   .E.A&C       AMID  &N1,1,1         AIF   '&C'<>'#',.B&B1      SETC  000&N1      AMID  &N1,2,L:&N1-1&C1      SETC  'DC D''&N1'''         AGO   .E.B         AIF   '&C'<>'{',.C&C       AMID  &N1,L:&N1,1         AIF   '&C'<>'}',.P&N1      AMID  &N1,2,L:&N1-2&B1      SETC  010         AGO   .D.C&B1      SETC  001.D&C1      SETC  'DC I''&N1'''.E         AIF   '&N2'<>'*',.F&B2      SETC  011&C2      SETC  ANOP         AGO   .J.F&C       AMID  &N2,1,1         AIF   '&C'<>'#',.G&B2      SETC  000&N2      AMID  &N2,2,L:&N2-1&C2      SETC  'DC D''&N2'''         AGO   .J.G         AIF   '&C'<>'{',.H&C       AMID  &N2,L:&N2,1         AIF   '&C'<>'}',.P&N2      AMID  &N2,2,L:&N2-2&B2      SETC  010         AGO   .I.H&B2      SETC  001.I&C2      SETC  'DC I''&N2'''.J         AIF   C:&N3>0,.K&B3      SETC  &B1         AIF   &ST1,.J1&C3      SETC  'DC I''&N1'''         AGO   .O.J1&C3      SETC  ANOP         AGO   .O.K         AIF   '&N3'<>'*',.L&B3      SETC  011&C3      SETC  ANOP         AGO   .O.L&C       AMID  &N3,1,1         AIF   '&C'<>'{',.M&C       AMID  &N3,L:&N3,1         AIF   '&C'<>'}',.P&N3      AMID  &N3,2,L:&N3-2&B3      SETC  010         AGO   .N.M&B3      SETC  001.N&C3      SETC  'DC I''&N3'''.O&LAB     JSR   SYSBOPR         DC    A'&SUB'         DC    B'101 &B1 101 &B2 &B3'         &C1         &C2         &C3         DC    R'SYSUNPD'         DC    R'SYSPAKD'         MEXIT.P         MNOTE 'Missing closing ''}''',16         MEND