******************************************************************  M6502.INT8MATH**  Eight byte integer mathematics.**  By Mike Westerfield*  Copyright (C) December 1984, All rights reserved*  By the Byte Works, Inc.*****************************************************************         MACRO&LAB     ABS8  &N1,&N2         LCLC  &C         LCLC  &C1         LCLC  &C2         LCLC  &B1         LCLC  &B2         LCLB  &ST1         AIF   "&N1"<>"*",.A&B1      SETC  011&ST1     SETB  1&C1      SETC  ANOP         AGO   .E.A&C       AMID  &N1,1,1         AIF   "&C"<>"#",.B&B1      SETC  000&N1      AMID  &N1,2,L:&N1-1&C1      SETC  "DC I8'&N1'"         AGO   .E.B         AIF   "&C"<>"{",.C&C       AMID  &N1,L:&N1,1         AIF   "&C"<>"}",.K&N1      AMID  &N1,2,L:&N1-2&B1      SETC  010         AGO   .D.C&B1      SETC  001.D&C1      SETC  "DC I'&N1'".E         AIF   C:&N2>0,.F&B2      SETC  &B1         AIF   &ST1,.E1&C2      SETC  "DC I'&N1'"         AGO   .J.E1&C2      SETC  ANOP         AGO   .J.F         AIF   "&N2"<>"*",.G&B2      SETC  011&C2      SETC  ANOP         AGO   .J.G&C       AMID  &N2,1,1         AIF   "&C"<>"{",.H&C       AMID  &N2,L:&N2,1         AIF   "&C"<>"}",.K&N2      AMID  &N2,2,L:&N2-2&B2      SETC  010         AGO   .I.H&B2      SETC  001.I&C2      SETC  "DC I'&N2'".J&LAB     JSR   SYSBOPR+8         DC    A"SYSSIG8"         DC    B"010 &B1 010 &B2"         &C1         &C2         MEXIT.K         MNOTE "Missing closing '}'",16         MEND         MACRO&LAB     ADD8  &N1,&N2,&N3         LCLC  &C         LCLC  &C1         LCLC  &C2         LCLC  &C3         LCLC  &B1         LCLC  &B2         LCLC  &B3         LCLB  &ST1         AIF   "&N1"<>"*",.A&B1      SETC  011&ST1     SETB  1&C1      SETC  ANOP         AGO   .E.A&C       AMID  &N1,1,1         AIF   "&C"<>"#",.B&B1      SETC  000&N1      AMID  &N1,2,L:&N1-1&C1      SETC  "DC I8'&N1'"         AGO   .E.B         AIF   "&C"<>"{",.C&C       AMID  &N1,L:&N1,1         AIF   "&C"<>"}",.P&N1      AMID  &N1,2,L:&N1-2&B1      SETC  010         AGO   .D.C&B1      SETC  001.D&C1      SETC  "DC I'&N1'".E         AIF   "&N2"<>"*",.F&B2      SETC  011&C2      SETC  ANOP         AGO   .J.F&C       AMID  &N2,1,1         AIF   "&C"<>"#",.G&B2      SETC  000&N2      AMID  &N2,2,L:&N2-1&C2      SETC  "DC I8'&N2'"         AGO   .J.G         AIF   "&C"<>"{",.H&C       AMID  &N2,L:&N2,1         AIF   "&C"<>"}",.P&N2      AMID  &N2,2,L:&N2-2&B2      SETC  010         AGO   .I.H&B2      SETC  001.I&C2      SETC  "DC I'&N2'".J         AIF   C:&N3>0,.K&B3      SETC  &B1         AIF   &ST1,.J1&C3      SETC  "DC I'&N1'"         AGO   .O.J1&C3      SETC  ANOP         AGO   .O.K         AIF   "&N3"<>"*",.L&B3      SETC  011&C3      SETC  ANOP         AGO   .O.L&C       AMID  &N3,1,1         AIF   "&C"<>"{",.M&C       AMID  &N3,L:&N3,1         AIF   "&C"<>"}",.P&N3      AMID  &N3,2,L:&N3-2&B3      SETC  010         AGO   .N.M&B3      SETC  001.N&C3      SETC  "DC I'&N3'".O&LAB     JSR   SYSBOPR         DC    A"SYSADD8"         DC    B"010 &B1 010 &B2 &B3"         &C1         &C2         &C3         MEXIT.P         MNOTE "Missing closing '}'",16         MEND         MACRO&LAB     CMP8  &N1,&N2         LCLC  &C         LCLC  &C1         LCLC  &C2         LCLC  &B1         LCLC  &B2         AIF   "&N1"<>"*",.A&B1      SETC  011&C1      SETC  ANOP         AGO   .E.A&C       AMID  &N1,1,1         AIF   "&C"<>"#",.B&B1      SETC  000&N1      AMID  &N1,2,L:&N1-1&C1      SETC  "DC I8'&N1'"         AGO   .E.B         AIF   "&C"<>"{",.C&C       AMID  &N1,L:&N1,1         AIF   "&C"<>"}",.K&N1      AMID  &N1,2,L:&N1-2&B1      SETC  010         AGO   .D.C&B1      SETC  001.D&C1      SETC  "DC I'&N1'".E         AIF   "&N2"<>"*",.F&B2      SETC  011&C2      SETC  ANOP         AGO   .J.F&C       AMID  &N2,1,1         AIF   "&C"<>"#",.G&B2      SETC  000&N2      AMID  &N2,2,L:&N2-1&C2      SETC  "DC I8'&N2'"         AGO   .J.G         AIF   "&C"<>"{",.H&C       AMID  &N2,L:&N2,1         AIF   "&C"<>"}",.K&N2      AMID  &N2,2,L:&N2-2&B2      SETC  010         AGO   .I.H&B2      SETC  001.I&C2      SETC  "DC I'&N2'".J&LAB     JSR   SYSBOPR+4         DC    A"SYSCMP8"         DC    B"010 &B1 010 &B2"         &C1         &C2         MEXIT.K         MNOTE "Missing closing '}'",16         MEND         MACRO&LAB     DIV8  &N1,&N2,&N3         LCLC  &C         LCLC  &C1         LCLC  &C2         LCLC  &C3         LCLC  &B1         LCLC  &B2         LCLC  &B3         LCLB  &ST1         AIF   "&N1"<>"*",.A&B1      SETC  011&ST1     SETB  1&C1      SETC  ANOP         AGO   .E.A&C       AMID  &N1,1,1         AIF   "&C"<>"#",.B&B1      SETC  000&N1      AMID  &N1,2,L:&N1-1&C1      SETC  "DC I8'&N1'"         AGO   .E.B         AIF   "&C"<>"{",.C&C       AMID  &N1,L:&N1,1         AIF   "&C"<>"}",.P&N1      AMID  &N1,2,L:&N1-2&B1      SETC  010         AGO   .D.C&B1      SETC  001.D&C1      SETC  "DC I'&N1'".E         AIF   "&N2"<>"*",.F&B2      SETC  011&C2      SETC  ANOP         AGO   .J.F&C       AMID  &N2,1,1         AIF   "&C"<>"#",.G&B2      SETC  000&N2      AMID  &N2,2,L:&N2-1&C2      SETC  "DC I8'&N2'"         AGO   .J.G         AIF   "&C"<>"{",.H&C       AMID  &N2,L:&N2,1         AIF   "&C"<>"}",.P&N2      AMID  &N2,2,L:&N2-2&B2      SETC  010         AGO   .I.H&B2      SETC  001.I&C2      SETC  "DC I'&N2'".J         AIF   C:&N3>0,.K&B3      SETC  &B1         AIF   &ST1,.J1&C3      SETC  "DC I'&N1'"         AGO   .O.J1&C3      SETC  ANOP         AGO   .O.K         AIF   "&N3"<>"*",.L&B3      SETC  011&C3      SETC  ANOP         AGO   .O.L&C       AMID  &N3,1,1         AIF   "&C"<>"{",.M&C       AMID  &N3,L:&N3,1         AIF   "&C"<>"}",.P&N3      AMID  &N3,2,L:&N3-2&B3      SETC  010         AGO   .N.M&B3      SETC  001.N&C3      SETC  "DC I'&N3'".O&LAB     JSR   SYSBOPR         DC    A"SYSDIV8"         DC    B"010 &B1 010 &B2 &B3"         &C1         &C2         &C3         MEXIT.P         MNOTE "Missing closing '}'",16         MEND         MACRO&LAB     MOD8  &N1,&N2,&N3         LCLC  &C         LCLC  &C1         LCLC  &C2         LCLC  &C3         LCLC  &B1         LCLC  &B2         LCLC  &B3         LCLB  &ST1         AIF   "&N1"<>"*",.A&B1      SETC  011&ST1     SETB  1&C1      SETC  ANOP         AGO   .E.A&C       AMID  &N1,1,1         AIF   "&C"<>"#",.B&B1      SETC  000&N1      AMID  &N1,2,L:&N1-1&C1      SETC  "DC I8'&N1'"         AGO   .E.B         AIF   "&C"<>"{",.C&C       AMID  &N1,L:&N1,1         AIF   "&C"<>"}",.P&N1      AMID  &N1,2,L:&N1-2&B1      SETC  010         AGO   .D.C&B1      SETC  001.D&C1      SETC  "DC I'&N1'".E         AIF   "&N2"<>"*",.F&B2      SETC  011&C2      SETC  ANOP         AGO   .J.F&C       AMID  &N2,1,1         AIF   "&C"<>"#",.G&B2      SETC  000&N2      AMID  &N2,2,L:&N2-1&C2      SETC  "DC I8'&N2'"         AGO   .J.G         AIF   "&C"<>"{",.H&C       AMID  &N2,L:&N2,1         AIF   "&C"<>"}",.P&N2      AMID  &N2,2,L:&N2-2&B2      SETC  010         AGO   .I.H&B2      SETC  001.I&C2      SETC  "DC I'&N2'".J         AIF   C:&N3>0,.K&B3      SETC  &B1         AIF   &ST1,.J1&C3      SETC  "DC I'&N1'"         AGO   .O.J1&C3      SETC  ANOP         AGO   .O.K         AIF   "&N3"<>"*",.L&B3      SETC  011&C3      SETC  ANOP         AGO   .O.L&C       AMID  &N3,1,1         AIF   "&C"<>"{",.M&C       AMID  &N3,L:&N3,1         AIF   "&C"<>"}",.P&N3      AMID  &N3,2,L:&N3-2&B3      SETC  010         AGO   .N.M&B3      SETC  001.N&C3      SETC  "DC I'&N3'".O&LAB     JSR   SYSBOPR         DC    A"SYSMOD8"         DC    B"010 &B1 010 &B2 &B3"         &C1         &C2         &C3         MEXIT.P         MNOTE "Missing closing '}'",16         MEND         MACRO&LAB     MUL8  &N1,&N2,&N3         LCLC  &C         LCLC  &C1         LCLC  &C2         LCLC  &C3         LCLC  &B1         LCLC  &B2         LCLC  &B3         LCLB  &ST1         AIF   "&N1"<>"*",.A&B1      SETC  011&ST1     SETB  1&C1      SETC  ANOP         AGO   .E.A&C       AMID  &N1,1,1         AIF   "&C"<>"#",.B&B1      SETC  000&N1      AMID  &N1,2,L:&N1-1&C1      SETC  "DC I8'&N1'"         AGO   .E.B         AIF   "&C"<>"{",.C&C       AMID  &N1,L:&N1,1         AIF   "&C"<>"}",.P&N1      AMID  &N1,2,L:&N1-2&B1      SETC  010         AGO   .D.C&B1      SETC  001.D&C1      SETC  "DC I'&N1'".E         AIF   "&N2"<>"*",.F&B2      SETC  011&C2      SETC  ANOP         AGO   .J.F&C       AMID  &N2,1,1         AIF   "&C"<>"#",.G&B2      SETC  000&N2      AMID  &N2,2,L:&N2-1&C2      SETC  "DC I8'&N2'"         AGO   .J.G         AIF   "&C"<>"{",.H&C       AMID  &N2,L:&N2,1         AIF   "&C"<>"}",.P&N2      AMID  &N2,2,L:&N2-2&B2      SETC  010         AGO   .I.H&B2      SETC  001.I&C2      SETC  "DC I'&N2'".J         AIF   C:&N3>0,.K&B3      SETC  &B1         AIF   &ST1,.J1&C3      SETC  "DC I'&N1'"         AGO   .O.J1&C3      SETC  ANOP         AGO   .O.K         AIF   "&N3"<>"*",.L&B3      SETC  011&C3      SETC  ANOP         AGO   .O.L&C       AMID  &N3,1,1         AIF   "&C"<>"{",.M&C       AMID  &N3,L:&N3,1         AIF   "&C"<>"}",.P&N3      AMID  &N3,2,L:&N3-2&B3      SETC  010         AGO   .N.M&B3      SETC  001.N&C3      SETC  "DC I'&N3'".O&LAB     JSR   SYSBOPR         DC    A"SYSMUL8"         DC    B"010 &B1 010 &B2 &B3"         &C1         &C2         &C3         MEXIT.P         MNOTE "Missing closing '}'",16         MEND         MACRO&LAB     RAN8  &N1         LCLC  &C         LCLC  &C1         LCLC  &B1         AIF   "&N1"<>"*",.A&B1      SETC  011&C1      SETC  ANOP         AGO   .E.A&C       AMID  &N1,1,1         AIF   "&C"<>"{",.C&C       AMID  &N1,L:&N1,1         AIF   "&C"<>"}",.K&N1      AMID  &N1,2,L:&N1-2&B1      SETC  010         AGO   .D.C&B1      SETC  001.D&C1      SETC  "DC I'&N1'".E&LAB     JSR   SYSBOPR+12         DC    A"SYSRANI"         DC    B"010 &B1"         DC    I1"0"         &C1         MEXIT.K         MNOTE "Missing closing '}'",16         MEND         MACRO&LAB     SIGN8 &N1,&N2         LCLC  &C         LCLC  &C1         LCLC  &C2         LCLC  &B1         LCLC  &B2         LCLB  &ST1         AIF   "&N1"<>"*",.A&B1      SETC  011&ST1     SETB  1&C1      SETC  ANOP         AGO   .E.A&C       AMID  &N1,1,1         AIF   "&C"<>"#",.B&B1      SETC  000&N1      AMID  &N1,2,L:&N1-1&C1      SETC  "DC I8'&N1'"         AGO   .E.B         AIF   "&C"<>"{",.C&C       AMID  &N1,L:&N1,1         AIF   "&C"<>"}",.K&N1      AMID  &N1,2,L:&N1-2&B1      SETC  010         AGO   .D.C&B1      SETC  001.D&C1      SETC  "DC I'&N1'".E         AIF   C:&N2>0,.F&B2      SETC  &B1         AIF   &ST1,.E1&C2      SETC  "DC I'&N1'"         AGO   .J.E1&C2      SETC  ANOP         AGO   .J.F         AIF   "&N2"<>"*",.G&B2      SETC  011&C2      SETC  ANOP         AGO   .J.G&C       AMID  &N2,1,1         AIF   "&C"<>"{",.H&C       AMID  &N2,L:&N2,1         AIF   "&C"<>"}",.K&N2      AMID  &N2,2,L:&N2-2&B2      SETC  010         AGO   .I.H&B2      SETC  001.I&C2      SETC  "DC I'&N2'".J&LAB     JSR   SYSBOPR+8         DC    A"SYSSGN8"         DC    B"010 &B1 010 &B2"         &C1         &C2         MEXIT.K         MNOTE "Missing closing '}'",16         MEND         MACRO&LAB     SQRT8 &N1,&N2         LCLC  &C         LCLC  &C1         LCLC  &C2         LCLC  &B1         LCLC  &B2         LCLB  &ST1         AIF   "&N1"<>"*",.A&B1      SETC  011&ST1     SETB  1&C1      SETC  ANOP         AGO   .E.A&C       AMID  &N1,1,1         AIF   "&C"<>"#",.B&B1      SETC  000&N1      AMID  &N1,2,L:&N1-1&C1      SETC  "DC I8'&N1'"         AGO   .E.B         AIF   "&C"<>"{",.C&C       AMID  &N1,L:&N1,1         AIF   "&C"<>"}",.K&N1      AMID  &N1,2,L:&N1-2&B1      SETC  010         AGO   .D.C&B1      SETC  001.D&C1      SETC  "DC I'&N1'".E         AIF   C:&N2>0,.F&B2      SETC  &B1         AIF   &ST1,.E1&C2      SETC  "DC I'&N1'"         AGO   .J.E1&C2      SETC  ANOP         AGO   .J.F         AIF   "&N2"<>"*",.G&B2      SETC  011&C2      SETC  ANOP         AGO   .J.G&C       AMID  &N2,1,1         AIF   "&C"<>"{",.H&C       AMID  &N2,L:&N2,1         AIF   "&C"<>"}",.K&N2      AMID  &N2,2,L:&N2-2&B2      SETC  010         AGO   .I.H&B2      SETC  001.I&C2      SETC  "DC I'&N2'".J&LAB     JSR   SYSBOPR+8         DC    A"SYSSQR8"         DC    B"010 &B1 010 &B2"         &C1         &C2         MEXIT.K         MNOTE "Missing closing '}'",16         MEND         MACRO&LAB     SUB8  &N1,&N2,&N3         LCLC  &C         LCLC  &C1         LCLC  &C2         LCLC  &C3         LCLC  &B1         LCLC  &B2         LCLC  &B3         LCLB  &ST1         AIF   "&N1"<>"*",.A&B1      SETC  011&ST1     SETB  1&C1      SETC  ANOP         AGO   .E.A&C       AMID  &N1,1,1         AIF   "&C"<>"#",.B&B1      SETC  000&N1      AMID  &N1,2,L:&N1-1&C1      SETC  "DC I8'&N1'"         AGO   .E.B         AIF   "&C"<>"{",.C&C       AMID  &N1,L:&N1,1         AIF   "&C"<>"}",.P&N1      AMID  &N1,2,L:&N1-2&B1      SETC  010         AGO   .D.C&B1      SETC  001.D&C1      SETC  "DC I'&N1'".E         AIF   "&N2"<>"*",.F&B2      SETC  011&C2      SETC  ANOP         AGO   .J.F&C       AMID  &N2,1,1         AIF   "&C"<>"#",.G&B2      SETC  000&N2      AMID  &N2,2,L:&N2-1&C2      SETC  "DC I8'&N2'"         AGO   .J.G         AIF   "&C"<>"{",.H&C       AMID  &N2,L:&N2,1         AIF   "&C"<>"}",.P&N2      AMID  &N2,2,L:&N2-2&B2      SETC  010         AGO   .I.H&B2      SETC  001.I&C2      SETC  "DC I'&N2'".J         AIF   C:&N3>0,.K&B3      SETC  &B1         AIF   &ST1,.J1&C3      SETC  "DC I'&N1'"         AGO   .O.J1&C3      SETC  ANOP         AGO   .O.K         AIF   "&N3"<>"*",.L&B3      SETC  011&C3      SETC  ANOP         AGO   .O.L&C       AMID  &N3,1,1         AIF   "&C"<>"{",.M&C       AMID  &N3,L:&N3,1         AIF   "&C"<>"}",.P&N3      AMID  &N3,2,L:&N3-2&B3      SETC  010         AGO   .N.M&B3      SETC  001.N&C3      SETC  "DC I'&N3'".O&LAB     JSR   SYSBOPR         DC    A"SYSSUB8"         DC    B"010 &B1 010 &B2 &B3"         &C1         &C2         &C3         MEXIT.P         MNOTE "Missing closing '}'",16         MEND