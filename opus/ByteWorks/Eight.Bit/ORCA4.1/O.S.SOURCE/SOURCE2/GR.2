******************************************************************  SYSGRDH - Double Hi Res Plot/Read**  By Mike Westerfield*  Copyright (C) June 1984, All rights reserved*  By the Byte Works, Inc.**  INPUTS:*        SYSX - X coordinate to plot or read*        SYSY - Y coordinate to plot or read*        SYSCOLOR - color to plot**  OUTPUTS:*        A - color of point read**  NOTES:*        1) Will not plot outside of the current window*        2) Returns black on reads outside of the physical*           screen******************************************************************SYSGRDH  STARTMR0      EQU   $C8                      macro registersMR1      EQU   $C9MR2      EQU   $CAMR3      EQU   $CBMASKL    EQU   $CCMASKH    EQU   $CDALTCHAR  EQU   $C055                    store to alternate memoryNORMCHAR EQU   $C054                    stroe to main memory;;  External constant definitions.;         DC    I'559'                   max X allowed         DC    I'191'                   max Y allowed         DC    B'1000 0000 0000 0001'   allowed colors mask         DC    I1'1'                    number of bits per pixel in block;;  Plot a point.;         LDA   SYSY+1                   insure that the point is in the         BNE   RTS                       current window         CMPW  SYSX,SYSGL         BLT   RTS         CMPW  SYSX,SYSGR         BGT   RTS         LDA   SYSY         CMP   SYSGB         BLT   RTS         CMP   SYSGT         BLE   PL0RTS      RTSPL0      MOVE  SYSX,MR0                 MR0 = byte number         JSR   SYSDIV7                  MR2 = bit number in first byte         LDA   MR0                      find the address of the line         LSR   A         TAY         PHP         JSR   SYSGBAS         LDX   MR2                      turn off the color bit         PLP         BCS   PL0A         STA   ALTCHARPL0A     LDA   (MR0),Y         AND   #$7F         AND   MASK,X                   and out the old bit         STA   MR2                      if the color is white, set the bit         LDA   SYSCOLOR         BEQ   PL1         LDA   MASK,X         EOR   #$FFPL1      ORA   MR2         STA   (MR0),Y                  save the result         STA   NORMCHAR         RTS;;  Read a point.;SYSRDDH  ENTRY         LDA   SYSY+1                   report black if the read is outside         BNE   RD0                       of the physical screen         CMPW  SYSX,#560         BGE   RD0         LDA   SYSY         CMP   #192         BLT   RD0ARD0      LDA   #0         RTSRD0A     MOVE  SYSX,MR0                 MR0 = byte number         JSR   SYSDIV7                  MR2 = bit number in first byte         LDA   MR0                      read the bit pattern         LSR   A         PHP         TAY         JSR   SYSGBAS         PLP         BCS   RD0B         STA   ALTCHARRD0B     LDA   (MR0),Y         LDX   MR2                      right justify it         BEQ   RD2RD1      LSR   A         DBNE  X,RD1RD2      AND   #1                       and out unneeded bits         TAX                            get the color bit         LDA   COLOR,X         STA   NORMCHAR         RTS;;  Local data areas.;MASK     DC    B'11111110'         DC    B'11111101'         DC    B'11111011'         DC    B'11110111'         DC    B'11101111'         DC    B'11011111'         DC    B'10111111'COLOR    DC    H'00 0F'         END******************************************************************  SYSGRHR - Hi Res Plot/Read**  By Mike Westerfield*  Copyright (C) June 1984, All rights reserved*  By the Byte Works, Inc.**  INPUTS:*        SYSX - X coordinate to plot or read*        SYSY - Y coordinate to plot or read*        SYSCOLOR - color to plot**  OUTPUTS:*        A - color of point read**  NOTES:*        1) Will not plot outside of the current window*        2) Returns black on reads outside of the physical*           screen******************************************************************SYSGRHR  STARTMR0      EQU   $C8                      macro registersMR1      EQU   $C9MR2      EQU   $CAMR3      EQU   $CBMASKL    EQU   $CCMASKH    EQU   $CD;;  External constant definitions.;         DC    I'279'                   max X allowed         DC    I'191'                   max Y allowed         DC    B'1000 0000 0000 0001'   allowed colors mask         DC    I1'1'                    number of bits per pixel in block;;  Plot a point.;         LDA   SYSY+1                   insure that the point is in the         BNE   RTS                       current window         CMPW  SYSX,SYSGL         BLT   RTS         CMPW  SYSX,SYSGR         BGT   RTS         LDA   SYSY         CMP   SYSGB         BLT   RTS         CMP   SYSGT         BLE   PL0RTS      RTSPL0      MOVE  SYSX,MR0                 MR0 = byte number         JSR   SYSDIV7                  MR2 = bit number in first byte         LDY   MR0                      find the address of the line         JSR   SYSGBAS         LDX   MR2                      turn off the color bit         LDA   (MR0),Y         AND   #$7F         AND   MASK,X                   and out the old bit         STA   MR2                      if the color is white, set the bit         LDA   SYSCOLOR         BEQ   PL1         LDA   MASK,X         EOR   #$FFPL1      ORA   MR2         STA   (MR0),Y                  save the result         RTS;;  Read a point.;SYSRDHR  ENTRY         LDA   SYSY+1                   report black if the read is outside         BNE   RD0                       of the physical screen         CMPW  SYSX,#280         BGE   RD0         LDA   SYSY         CMP   #192         BLT   RD0ARD0      LDA   #0         RTSRD0A     MOVE  SYSX,MR0                 MR0 = byte number         JSR   SYSDIV7                  MR2 = bit number in first byte         LDY   MR0                      read the bit pattern         JSR   SYSGBAS         LDA   (MR0),Y         LDX   MR2                      right justify it         BEQ   RD2RD1      LSR   A         DBNE  X,RD1RD2      AND   #1                       and out unneeded bits         TAX                            get the color bit         LDA   COLOR,X         RTS;;  Local data areas.;MASK     DC    B'11111110'         DC    B'11111101'         DC    B'11111011'         DC    B'11110111'         DC    B'11101111'         DC    B'11011111'         DC    B'10111111'COLOR    DC    H'00 0F'         END******************************************************************  SYSGRDL - Double Low Res Graphics Plot/Read**  By Mike Westerfield*  Copyright (C) June 1984, All rights reserved*  By the Byte Works, Inc.**  INPUTS:*        SYSX - X coordianate to plot or read*        SYSY - Y coordianate to plot or read*        SYSCOLOR - color to plot**  OUTPUTS:*        A - color of point read**  NOTES:*        1) Will not plot outside of the current window.*        2) Returns black on reads outside of the physical*           screen.******************************************************************SYSGRDL  STARTALTCHAR  EQU   $C055                    alternate pageNORMCHAR EQU   $C054                    normal pagePLOT     EQU   $F800                    plot to the low-res screenSETCOL   EQU   $F864                    set low-res screen plot colorSCRN     EQU   $F871                    read the low-res screen;;  External constant definitions.;         DC    I'79'                    max X allowed         DC    I'47'                    max Y allowed         DC    B'1111 1111 1111 1111'   allowed colors mask         DC    I1'4'                    number of bits per pixel in block;;  Plot a point;         LDA   SYSX                     set the color         LSR   A         BCC   PL0         LDA   SYSCOLOR         BPL   PL0APL0      LDX   SYSCOLOR         LDA   DCOLORS,XPL0A     JSR   SETCOL         LDA   SYSX+1                   insure the point is in the window         ORA   SYSY+1         BNE   RTS         LDA   SYSX         CMP   SYSGL         BLT   RTS         CMP   SYSGR         BGT   RTS         LSR   A                        handle the page selection         BCS   PL1         STA   ALTCHARPL1      TAY         LDA   SYSY                     finish checking Y to make sure its in         CMP   SYSGB                     the window         BLT   RTS         CMP   SYSGT         BGT   RTS         SEC                            correct for flipped Y direction         LDA   #47         SBC   SYSY         JSR   PLOT                     plot the point         STA   NORMCHAR         RTS;;  Read a point.;SYSRDDL  ENTRY         LDA   SYSX+1                   if outside physical screen, return         ORA   SYSY+1                    black (0)         BNE   RD1         LDA   SYSX         CMP   #80         BGE   RD1         LSR   A         BCS   RD0         STA   ALTCHARRD0      TAY         SEC         LDA   #47         SBC   SYSY         BCC   RD1         JSR   SCRN                     read the point         STA   NORMCHAR         TAX         LDA   SYSX         LSR   A         BCS   RD0A         LDA   NCOLORS,X         RTSRD0A     TXA         RTSRD1      LDA   #0                       return blackRTS      STA   NORMCHAR         RTSNCOLORS  DC    H'00 02 04 06 08 0A 0C 0E 01 03 05 07 09 0B 0D 0F'DCOLORS  DC    H'00 08 01 09 02 0A 03 0B 04 0C 05 0D 06 0E 07 0F'         DC    R'SYSPLOT'         END******************************************************************  SYSGRL1 - Low Resolution Graphics Plot/Read**  By Mike Westerfield*  Copyright (C) June 1984, All rights reserved*  By the Byte Works, Inc.**  INPUTS:*        SYSX - X coordianate to plot or read*        SYSY - Y coordianate to plot or read*        SYSCOLOR - color to plot**  OUTPUTS:*        A - color of point read**  NOTES:*        1) Will not plot outside of the current window.*        2) Returns black on reads outside of the physical*           screen.******************************************************************SYSGRL1  STARTPLOT     EQU   $F800                    plot to the low-res screenSETCOL   EQU   $F864                    set low-res screen plot colorSCRN     EQU   $F871                    read the low-res screen;;  External constant definitions.;         DC    I'39'                    max X allowed         DC    I'47'                    max Y allowed         DC    B'1111 1111 1111 1111'   allowed colors mask         DC    I1'4'                    number of bits per pixel in block;;  Plot a point;         LDA   SYSCOLOR                 set the plot color         JSR   SETCOL         LDA   SYSX+1                   insure the point is in the window         ORA   SYSY+1         BNE   RTS         LDY   SYSX         CPY   SYSGL         BLT   RTS         CPY   SYSGR         BGT   RTS         LDA   SYSY         CMP   SYSGB         BLT   RTS         CMP   SYSGT         BGT   RTS         SEC                            correct for flipped Y direction         LDA   #47         SBC   SYSY         JMP   PLOT                     plot the point;;  Read a point.;SYSRDL1  ENTRY         LDA   SYSX+1                   if outside physical screen, return         ORA   SYSY+1                    black (0)         BNE   RD1         LDY   SYSX         CPY   #40         BGE   RD1         SEC         LDA   #47         SBC   SYSY         BCC   RD1         JMP   SCRN                     read the pointRD1      LDA   #0                       return blackRTS      RTS         DC    R'SYSPLOT'         END******************************************************************  SYSGRL2 - Page 2 Low Resolution Graphics Plot/Read**  By Mike Westerfield*  Copyright (C) June 1984, All rights reserved*  By the Byte Works, Inc.**  INPUTS:*        SYSX - X coordianate to plot or read*        SYSY - Y coordianate to plot or read*        SYSCOLOR - color to plot**  OUTPUTS:*        A - color of point read**  NOTES:*        1) Will not plot outside of the current window.*        2) Returns black on reads outside of the physical*           screen.******************************************************************SYSGRL2  STARTGBASH    EQU   $27                      high byte of graphics base addrPLOT2    EQU   $F805                    entry point in point plot routineGBASCALC EQU   $F847                    calculate graphics base addrSETCOL   EQU   $F864                    set the plot colorSCRN2    EQU   $F876                    entry point in point read routine;;  External constant definitions.;         DC    I'39'                    max X allowed         DC    I'47'                    max Y allowed         DC    B'1111 1111 1111 1111'   allowed colors mask         DC    I1'4'                    number of bits per pixel in block;;  Plot a point;         LDA   SYSCOLOR                 set the plot color         JSR   SETCOL         LDA   SYSX+1                   insure the point is in the window         ORA   SYSY+1         BNE   RTS         LDY   SYSX         CPY   SYSGL         BLT   RTS         CPY   SYSGR         BGT   RTS         LDA   SYSY         CMP   SYSGB         BLT   RTS         CMP   SYSGT         BGT   RTS         SEC                            correct for flipped Y direction         LDA   #47         SBC   SYSY         LSR   A         PHP         JSR   GBASCALC         LDA   GBASH         EOR   #%00001100         STA   GBASH         JMP   PLOT2;;  Read a point.;SYSRDL2  ENTRY         LDA   SYSX+1                   if outside physical screen, return         ORA   SYSY+1                    black (0)         BNE   RD1         LDY   SYSX         CPY   #40         BGE   RD1         SEC         LDA   #47         SBC   SYSY         BCC   RD1         LSR   A                        read the point         PHP         JSR   GBASCALC         LDA   GBASH         EOR   #%00001100         STA   GBASH         JMP   SCRN2RD1      LDA   #0                       return blackRTS      RTS         DC    R'SYSPLOT'         END         APPEND GR.3