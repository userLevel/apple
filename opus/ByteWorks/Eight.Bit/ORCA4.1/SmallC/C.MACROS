 MACRO LDCI &C LCLA &N LCLC &A&A AMID &C,1,1&N ASEARCH 0123456789-,&A,1 SEC LDA $98 SBC #4 STA $98 BCS A&SYSCNT DEC $99A&SYSCNT JSR SYSCSTK LDA #&C AIF (&C>255).OR.(&N=0),.A JSR SYSCBOOL MEXIT.A LDY #0 STA ($98),Y INY LDA #>&C STA ($98),Y INY LDA #^&C STA ($98),Y INY LDA #(&C)|-24 STA ($98),Y MEND MACRO CUP &P,&A CLC LDA #&P ADC $98 STA $A0 LDA #>&P ADC $99 STA $A1 JSR &A MEND MACRO MST JSR SYSCMST MEND MACRO LAO &D SEC LDA $98 SBC #4 STA $98 BCS A&SYSCNT DEC $99A&SYSCNT SEC LDY #0 LDA $A0 SBC #&D STA ($98),Y INY LDA $A1 SBC #>&D STA ($98),Y LDA #0 INY STA ($98),Y INY STA ($98),Y MEND MACRO POPI JSR SYSCPOPI MEND MACRO INDI JSR SYSCINDI MEND MACRO FJP &L LDY #3 LDA #0A&SYSCNT ORA ($98),Y DEY BPL A&SYSCNT PHA CLC LDA $98 ADC #4 STA $98 BCC B&SYSCNT INC $99B&SYSCNT PLA BNE C&SYSCNT JMP &LC&SYSCNT ANOP MEND MACRO ADI JSR SYSCADI MEND MACRO UJP &L JMP &L MEND MACRO RET JMP SYSCRET MEND MACRO LDOI &A SEC LDA $98 SBC #4 STA $98 BCS A&SYSCNT DEC $99A&SYSCNT JSR SYSCSTK LDY #0 LDA &A STA ($98),Y INY LDX #0 LDA &A+1 STA ($98),Y BPL B&SYSCNT DEXB&SYSCNT TXA INY STA ($98),Y INY STA ($98),Y MEND MACRO SHL JSR SYSCSHL MEND MACRO STOI JSR SYSCSTOI MEND MACRO EQL JSR SYSCEQL MEND MACRO INDL JSR SYSCINDL MEND MACRO ADR &A DC A'&A' MEND MACRO ENT &A AIF &A=0,.C SEC LDA $98 SBC #&A STA $98 AIF &A>255,.A BCS A&SYSCNT DEC $99A&SYSCNT ANOP AGO .B.A LDA $99 ADC #>&A STA $99.B JSR SYSCSTK.C MEND MACRO INDC JSR SYSCINDC MEND MACRO SROI &A LDY #0 LDA ($98),Y STA &A INY LDA ($98),Y STA &A+1 CLC LDA $98 ADC #4 STA $98 BCC A&SYSCNT INC $99A&SYSCNT ANOP MEND MACRO NOT JSR SYSCNOT MEND MACRO STOL JSR SYSCSTOL MEND MACRO INCI JSR SYSCINCI MEND MACRO CROI &A LDY #0 LDA ($98),Y STA &A INY LDA ($98),Y STA &A+1 MEND MACRO CPOI JSR SYSCCPOI DC R'SYSCCPOC' MEND MACRO DECI JSR SYSCDECI MEND MACRO NEQ JSR SYSCNEQ MEND MACRO STOC JSR SYSCSTOC MEND MACRO LAND JSR SYSCLND MEND MACRO LES JSR SYSCLES MEND MACRO SBI JSR SYSCSBI MEND MACRO ANDI JSR SYSCANDI MEND MACRO IOR JSR SYSCIOR MEND MACRO CPOC JSR SYSCCPOC DC R'SYSCCPOC' MEND MACRO GEQ JSR SYSCGEQ MEND MACRO CPOL JSR SYSCCPOL DC R'SYSCCPOC' MEND MACRO LOR JSR SYSCLOR DC R'SYSCLND' MEND MACRO MPI JSR SYSCMPI MEND MACRO XJP LDA #E&SYSCNT STA $90 LDA #>E&SYSCNT STA $91 JSR SYSCXJP JMP ($90)E&SYSCNT ANOP MEND MACRO DVI JSR SYSCDVI MEND MACRO NGI JSR SYSCNGI MEND MACRO SHR JSR SYSCSHR MEND MACRO UGE JSR SYSCUGE MEND MACRO LEQ JSR SYSCLEQ MEND MACRO MOD JSR SYSCMOD MEND MACRO ULT JSR SYSCULT MEND MACRO CROC &A LDY #0 LDA ($98),Y STA &A MEND MACRO GRT JSR SYSCGRT MEND MACRO LDOC &A SEC LDA $98 SBC #4 STA $98 BCS A&SYSCNT DEC $99A&SYSCNT JSR SYSCSTK LDA &A JSR SYSCBOOL DC R'SYSCFALSE' MEND MACRO ULE JSR SYSCULE MEND MACRO UGT JSR SYSCUGT MEND MACRO XOR JSR SYSCXOR MEND MACRO OCP JSR SYSCOCP MEND MACRO TJP &L LDY #3 LDA #0A&SYSCNT ORA ($98),Y DEY BPL A&SYSCNT PHA CLC LDA $98 ADC #4 STA $98 BCC B&SYSCNT INC $99B&SYSCNT PLA BEQ C&SYSCNT JMP &LC&SYSCNT ANOP MEND MACRO SROC &A LDY #0 LDA ($98),Y STA &A CLC LDA $98 ADC #4 STA $98 BCC A&SYSCNT INC $99A&SYSCNT ANOP MEND MACRO CROL &A LDY #3A&SYSCNT LDA ($98),Y STA &A,Y DEY BPL A&SYSCNT MEND MACRO LDOL &A SEC LDA $98 SBC #4 STA $98 BCS A&SYSCNT DEC $99A&SYSCNT JSR SYSCSTK LDY #3B&SYSCNT LDA &A,Y STA ($98),Y DEY BPL B&SYSCNT MEND MACRO SROL &A LDY #3B&SYSCNT LDA ($98),Y STA &A,Y DEY BPL B&SYSCNT CLC LDA $98 ADC #4 STA $98 BCC A&SYSCNT INC $99A&SYSCNT ANOP MEND MACRO INIT JMP SYSINITC MEND