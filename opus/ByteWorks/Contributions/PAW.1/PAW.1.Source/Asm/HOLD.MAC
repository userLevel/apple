 MACRO&lab str &string&lab dc i1'L:&string',C'&string' MEND MACRO&lab writestr &addr&lab ANOP AIF C:&addr=0,.c lclc &char&char amid &addr,1,1 AIF "&char"="#",.a pea &addr|-16 pea &addr ago .b.a lclc &str&str amid &addr,3,L:&addr-3 bra ~b&SYSCNT~a&SYSCNT dc i1'L:&str',C'&str'~b&SYSCNT pea ~a&SYSCNT|-16 pea ~a&SYSCNT.b ldx #$1C0C jsl $E10000 MEXIT.c phy pha AGO .b MEND MACRO&lab writeln &addr&lab ANOP AIF C:&addr=0,.c lclc &char&char amid &addr,1,1 AIF "&char"="#",.a pea &addr|-16 pea &addr ago .b.a lclc &str&str amid &addr,3,L:&addr-3 bra ~b&SYSCNT~a&SYSCNT dc I1'L:&str',C'&str'~b&SYSCNT pea ~a&SYSCNT|-16 pea ~a&SYSCNT.b ldx #$1A0C~c&SYSCNT jsl $E10000 MEXIT.c pea +(~c&SYSCNT+1)|-16 pea ~c&SYSCNT+1 AGO .b MEND MACRO&lab longm&lab ANOP rep #%00100000 longa on MEND MACRO&lab shortm&lab ANOP sep #%00100000 longa off MEND MACRO&lab dp &pointer&lab dc i4'&pointer' MEND macro&l ~EMStatus&l ldx #$0606 jsl $E10000 mend macro&l ~EventAvail &p1,&p2&l ph2 &p1 ph4 &p2 ldx #$0B06 jsl $E10000 mend macro&l ~FlushEvents &p1,&p2&l ph2 &p1 ldx #$1506 ph2 &p2 jsl $E10000 mend macro&l ~ClearMouse&l ldx #$1B03 jsl $E10000 mend macro&l ~InitMouse &p1&l ph2 &p1 ldx #$1803 jsl $E10000 mend macro&l ~PosMouse &p1,&p2&l ph2 &p1 ph2 &p2 ldx #$1E03 jsl $E10000 mend macro&l ~ReadMouse&l ldx #$1703 jsl $E10000 mend macro&l ~SetMouse &p1&l ph2 &p1 ldx #$1903 jsl $E10000 mend macro&l ~GetOutGlobals&l ldx #$0D0C jsl $E10000 mend macro&l ~GetOutputDevice&l ldx #$130C jsl $E10000 mend macro&l ~InitTextDev &p1&l ph2 &p1 ldx #$150C jsl $E10000 mend macro&l ~SetOutGlobals &p1,&p2&l ph2 &p1 ph2 &p2 ldx #$0A0C jsl $E10000 mend macro&l ~SetOutputDevice &p1,&p2&l ph2 &p1 ph4 &p2 ldx #$100C jsl $E10000 mend macro&l ph2 &n1 aif "&n1"="*",.f lclc &c&l anop&c amid &n1,1,1 aif "&c"="#",.d aif s:longa=1,.a rep #%00100000.a aif "&c"<>"{",.b&c amid &n1,l:&n1,1 aif "&c"<>"}",.g&n1 amid &n1,2,l:&n1-2 lda (&n1) pha ago .e.b aif "&c"="<",.c lda &n1 pha ago .e.c&n1 amid &n1,2,l:&n1-1 pei &n1 ago .e.d&n1 amid &n1,2,l:&n1-1 pea &n1 ago .f.e aif s:longa=1,.f sep #%00100000.f mexit.g mnote "Missing closing '}'",16 mend macro&l ph4 &n1 aif "&n1"="*",.f lclc &c&l anop&c amid &n1,1,1 aif "&c"="#",.d aif s:longa=1,.a rep #%00100000.a aif "&c"<>"{",.b&c amid &n1,l:&n1,1 aif "&c"<>"}",.g&n1 amid &n1,2,l:&n1-2 ldy #2 lda (&n1),y pha lda (&n1) pha ago .e.b aif "&c"<>"[",.c ldy #2 lda &n1,y pha lda &n1 pha ago .e.c aif "&c"<>"<",.c1&n1 amid &n1,2,l:&n1-1 pei &n1+2 pei &n1 ago .e.c1 lda &n1+2 pha lda &n1 pha ago .e.d&n1 amid &n1,2,l:&n1-1 pea +(&n1)|-16 pea &n1 ago .f.e aif s:longa=1,.f sep #%00100000.f mexit.g mnote "Missing closing '}'",16 mend