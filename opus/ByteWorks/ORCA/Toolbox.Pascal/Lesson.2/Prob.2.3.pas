{---------------------------------------------------------------}{                                                               }{  Beep                                                         }{                                                               }{  Road runner simulation.                                      }{                                                               }{---------------------------------------------------------------}program Quit;uses Common, QuickDrawII, EventMgr, WindowMgr, ControlMgr, DeskMgr,     DialogMgr, MenuMgr, MscToolSet;const   return        = 13;                  {return key code}    file_Quit     = 256;                 {Menu ID #s}   beep_Beep1    = 301;   beep_Beep2    = 302;   beep_Beep3    = 303;type   long = record                        {for splitting 4 bytes to 2 bytes}      case boolean of         true : (long: longint);         false: (lsw,msw: integer);      end;var   done: boolean;                       {tells if the program should stop}   myEvent: eventRecord;                {last event returned in event loop}   menuNum,menuItemNum: integer;        {menu number & menu item number}   where: integer;                      {where the mouse event occurred}   wPtr: grafPortPtr;                   {window where event occurred}   procedure InitMenus;   { Initialize the menu bar.                                   }    var      height: integer;                  {height of the largest menu}      menuHand: menuHandle;             {for 'handling' windows}      s: textPtr;                       {for building menus}    begin {InitMenus}   new(s);                              {create the beep menu}   s^ := concat('>> Beep \N3',chr(return));   s^ := concat(s^,'--One\N301*11',chr(return));   s^ := concat(s^,'--Two\N302*22',chr(return));   s^ := concat(s^,'--Three\N303*33',chr(return));   s^ := concat(s^,'.',chr(return));   menuHand := NewMenu(s);   InsertMenu(menuHand,0);   new(s);                              {create the file menu}   s^ := concat('>> File \N1',chr(return));   s^ := concat(s^,'--Quit\N256*Qq',chr(return));   s^ := concat(s^,'.',chr(return));   menuHand := NewMenu(s);   InsertMenu(menuHand,0);   height := FixMenuBar;                {draw the completed menu bar}   DrawMenuBar;   end; {InitMenus}    procedure HandleMenu;   { Handle a menu selection.                                   }   procedure Beep (times: integer);   { Beep some number of times                                  }   {                                                            }   { Parameters:                                                }   {    times - number of times to beep                         }   var      i: integer;                       {loop counter}   begin {Beep}   for i := 1 to times do      SysBeep;   end; {Beep}   begin {HandleMenu}   case menuItemNum of                  {go handle the menu}      file_Quit:   done := true;      beep_Beep1:  Beep(1);      beep_Beep2:  Beep(2);      beep_Beep3:  Beep(3);      otherwise:   ;      end; {case}   HiliteMenu(false, menuNum);          {unhighlight the menu}   end; {HandleMenu}begin {Quit}StartDesk(640);InitMenus;                              {set up the menu bar}InitCursor;                             {show the cursor}done := false;                          {main event loop}repeat   if GetNextEvent(everyEvent, myEvent) then      case myEvent.eventWhat of         mouseDownEvt: begin            with myEvent.eventWhere do               where := FindWindow(wPtr, h, v);            if where = wInMenuBar then begin               MenuSelect(myEvent, nil);               menuNum := long(myEvent.taskData).msw;               menuItemNum := long(myEvent.taskData).lsw;               if menuItemNum <> 0 then                  HandleMenu;               end; {if}            end;         keyDownEvt, autoKeyEvt: begin            if (myEvent.eventModifiers & appleKey) <> 0 then begin               MenuKey(myEvent, nil);               menuNum := long(myEvent.taskData).msw;               menuItemNum := long(myEvent.taskData).lsw;               if menuItemNum <> 0 then                  HandleMenu;               end; {if}            end;         otherwise: {do nothing};         end; {case}until done;EndDesk;end. {Quit}