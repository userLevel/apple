{---------------------------------------------------------------}{                                                               }{  Sine Wave Generator                                          }{                                                               }{---------------------------------------------------------------}program SineWave (input, output);uses Common, SoundMgr, ResourceMgr, MemoryMgr, ToolLocator, MscToolSet;label 98, 99;const   twoPi = 6.28318531;                  {2*pi}var   i: integer;                          {loop/index variable}   soundBlock: soundParamBlock;         {sound parameter block}   soundHandle: handle;                 {sound block handle}   soundPtr: ptr;                       {sound block pointer}   startStopParm: longint;              {tool start/shutdown parameter}begin {SineWave}startStopParm :=                        {start up the tools}   StartUpTools(userID, 2, 1);if ToolError <> 0 then begin   writeln('Could not start tools: ', ToolError:1);   goto 99;   end; {if}                                        {create the sound buffer}soundHandle := NewHandle($010000, userID, $C014, nil);if ToolError <> 0 then begin   writeln('Could not allocate a sound buffer: ', ToolError:1);   goto 98;   end; {if}writeln('Setting up the sound...');     {put a sine wave in the buffer}soundPtr := soundHandle^;for i := 1 to 256 do begin   soundPtr^ := round(sin(i/256.0*twoPi)*120 + 128);   soundPtr := pointer(ord4(soundPtr)+1);   end; {for}with soundBlock do begin                {set up the sound parameter block}   waveStart := soundHandle^;   waveSize := 1;   freqOffset := round(32.0*65536.0/1645.0);   DOCBuffer := 0;   DOCBufferSize := 0;   nextWaddr := @soundBlock;   volSetting := 250;   end; {with}writeln('Playing the sound...');        {start the sound}FFStartSound($0201, soundBlock);writeln('Press return to stop the sound.');readln;                                 {wait for a keypress}FFStopSound($7FFF);                     {stop the sound}98:ShutDownTools(1, startStopParm);        {shut down the tools}99:end. {SineWave}