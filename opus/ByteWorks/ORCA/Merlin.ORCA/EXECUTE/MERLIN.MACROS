         MACRO&LAB     FLS   &STR,&HEX         LCLA  &POS         LCLA  &ASCII         LCLC  &C1         LCLC  &C2         LCLC  &COMMA&COMMA   SETC  ","&POS     SETA  1.A&C1      AMID  "&STR",&POS,1&ASCII   SETA  "&C1"         AIF   &ASCII>=$40,.B&ASCII   SETA  &ASCII+$40         AGO   .C.B         AIF   &ASCII<$80,.C&ASCII   SETA  &ASCII-$40.C&C2      SETC  "&C2"+"&COMMA"+"&ASCII"&POS     SETA  &POS+1         AIF   &POS<=L:&STR,^A&C2      AMID  "&C2",2,L:&C2&LAB     DC    I1"&C2"         AIF   C:&HEX,.D         MEXIT.D         DC    H"&HEX"         MEND         MACRO&LAB     FLSH  &STR,&HEX         LCLA  &POS         LCLA  &ASCII         LCLC  &C1         LCLC  &C2         LCLC  &COMMA&COMMA   SETC  ","&POS     SETA  1.A&C1      AMID  "&STR",&POS,1&ASCII   SETA  "&C1"         AIF   &ASCII>=$40,.B&ASCII   SETA  &ASCII+$40         AGO   .C.B         AIF   &ASCII<$80,.C&ASCII   SETA  &ASCII-$40.C&C2      SETC  "&C2"+"&COMMA"+"&ASCII"&POS     SETA  &POS+1         AIF   &POS<=L:&STR,^A&C2      AMID  "&C2",2,L:&C2         MSB   ON&LAB     DC    I1"&C2"         MSB   OFF         AIF   C:&HEX,.D         MEXIT.D         DC    H"&HEX"         MEND         MACRO&LAB     INV   &STR,&HEX         LCLA  &POS         LCLA  &ASCII         LCLC  &C1         LCLC  &C2         LCLC  &COMMA&COMMA   SETC  ","&POS     SETA  1.A&C1      AMID  "&STR",&POS,1&ASCII   SETA  "&C1"         AIF   &ASCII<=$3F,.B&ASCII   SETA  &ASCII-$40.B&C2      SETC  "&C2"+"&COMMA"+"&ASCII"&POS     SETA  &POS+1         AIF   &POS<=L:&STR,^A&C2      AMID  "&C2",2,L:&C2&LAB     DC    I1"&C2"         AIF   C:&HEX,.C         MEXIT.C         DC    H"&HEX"         MEND         MACRO&LAB     INVH  &STR,&HEX         LCLA  &POS         LCLA  &ASCII         LCLC  &C1         LCLC  &C2         LCLC  &COMMA&COMMA   SETC  ","&POS     SETA  1.A&C1      AMID  "&STR",&POS,1&ASCII   SETA  "&C1"         AIF   &ASCII<=$3F,.B&ASCII   SETA  &ASCII-$40.B&C2      SETC  "&C2"+"&COMMA"+"&ASCII"&POS     SETA  &POS+1         AIF   &POS<=L:&STR,^A&C2      AMID  "&C2",2,L:&C2         MSB   ON&LAB     DC    I1"&C2"         MSB   OFF         AIF   C:&HEX,.C         MEXIT.C         DC    H"&HEX"         MEND         MACRO&LAB     REV   &STR         LCLA  &A&A       SETA  L:&STR         LCLC  &C1         LCLC  &C2.A&C1      AMID  "&STR",&A,1&C2      SETC  "&C2"+"&C1"&A       SETA  &A-1         AIF   &A,^A&LAB     DC    C"&C2"         MEND         MACRO&LAB     REVH  &STR         LCLA  &A&A       SETA  L:&STR         LCLC  &C1         LCLC  &C2.A&C1      AMID  "&STR",&A,1&C2      SETC  "&C2"+"&C1"&A       SETA  &A-1         AIF   &A,^A         MSB   ON&LAB     DC    C"&C2"         MSB   OFF         MEND         MACRO&LAB     DCI   &STR,&HEX         AIF   C:&STR,.A         AIF   C:&HEX,.B         MEXIT.A         LCLA  &A&A       SETA  L:&STR-1         LCLC  &C1         LCLC  &C2&C1      AMID  "&STR",1,&A&C2      AMID  "&STR",&A+1,1&LAB     DC    C"&C1"         MSB   ON         DC    C"&C2"         MSB   OFF         AIF   C:&HEX,.B         MEXIT.B         DC    H"&HEX"         MEND         MACRO&LAB     DCIH  &STR,&HEX         AIF   C:&STR,.A         AIF   C:&HEX,.B         MEXIT.A         LCLA  &A&A       SETA  L:&STR-1         LCLC  &C1         LCLC  &C2&C1      AMID  "&STR",1,&A&C2      AMID  "&STR",&A+1,1         MSB   ON&LAB     DC    C"&C1"         MSB   OFF         DC    C"&C2"         AIF   C:&HEX,.B         MEXIT.B         DC    H"&HEX"         MEND         MACRO&LAB     ASC   &STR,&HEX&LAB     DC    C"&STR"         AIF   C:&HEX,.A         MEXIT.A         DC    H"&HEX"         MEND         MACRO&LAB     ASCH  &STR,&HEX         MSB   ON&LAB     DC    C"&STR"         MSB   OFF         AIF   C:&HEX,.A         MEXIT.A         DC    H"&HEX"         MEND         MACRO&LAB     STR   &STR,&HEX&LAB     DC    I1"L:SYSA&SYSCNT"SYSA&SYSCNT  DC  C"&STR"         AIF   C:&HEX,.A         MEXIT.A         DC    H"&HEX"         MEND         MACRO&LAB     STRH  &STR,&HEX         MSB   ON&LAB     DC    I1"L:SYSA&SYSCNT"SYSA&SYSCNT  DC  C"&STR"         MSB   OFF         AIF   C:&HEX,.A         MEXIT.A         DC    H"&HEX"         MEND         MACRO&LAB     DUM   &A&LAB     OBJ   &A         GBLA  &DUM&DUM     SETA  &A;&dum         MEND         MACRO&LAB     DEND         OBJEND&LAB     ANOP         ORG   *-&DUM         MEND         MACRO&LAB     DDB   &N         LCLA  &CNT         LCLA  &A&A       SETA  C:&N&LAB     ANOP&CNT     SETA  1.TOP         DC    I1>'&N(&CNT)'         DC    I1'&N(&CNT)'&CNT     SETA  &CNT+1         AIF   &CNT<=&A,^TOP         MEND         MACRO&LAB     MDS   &N1,&N2         AIF   "&N1"<>"\",.A&LAB     ALIGN 256         MEXIT.A         LCLA  &A&A       SETA  &N1         AIF   C:&N2,.C         AIF   &A<0,.B&LAB     DS    &A         MEXIT.B&LAB     ORG   *-&A         MEXIT.C&LAB     DC    &A.I1"&N2"         MEND         MACRO&LAB     MX    &N1&LAB     ANOP         LONGA OFF         LONGI OFF         LCLA  &A&A       SETA  &N1         AIF   &A=0,.A         AIF   &A=1,.B         AIF   &A=2,.C         MEXIT.A         LONGA ON         LONGI ON         MEXIT.B         LONGI ON         MEXIT.C         LONGA ON         MEND         MACRO&LAB     KBD   &STR         LCLC  &C         AIF   C:&STR,.A&C       AINPUT "Give value for &LAB: "         AGO   .B.A&C       AINPUT "&STR".B&LAB     EQU   "&C"         MEND