{$keep 'KScope'}{---------------------------------------------------------------}{                                                               }{  KaleidoScope                                                 }{                                                               }{  This program draws a pattern on the 16 color screen.  It     }{  takes a little time to start to look good, so be patient.    }{  Change loopcnt to make the program run longer (or to make    }{  it finish sooner).  Adapted from an old integer BASIC        }{  program.                                                     }{                                                               }{  Note: Running time is approximately 10*loopcnt minutes. Thus,}{  as the program is set up now, it runs for about 30 minutes.  }{  Hold down the open-Apple key and type a period to exit       }{  early.                                                       }{                                                               }{  By Mike Westerfield                                          }{                                                               }{  Copyright 1987-1990                                          }{  Byte Works, Inc.                                             }{                                                               }{---------------------------------------------------------------}program KaleidoScope;uses   Common, QuickDrawII, ORCAShell;label 1;const  loopcnt       =   3;                  { # times to do it }  size          = 320;                  { size of screen }var  i, j, k, w, temp, temp2: integer;  stopVar:                 stopDCB;   (***************************************************************   *   *  procedure Plot:  Plot a point.   *   ***************************************************************)   procedure Plot (h, v: integer);   const    disp        = 60;                   { correct for oblong screen }   begin { Plot }   MoveTo (h, v - disp);   LineTo (h, v - disp);   end; { Plot }begin { KelidaScope }StartGraph (320);SetPenMode (0);for w := 1 to loopcnt do   for i := 1 to size div 2 do       for j := 1 to size div 2 do begin           k := i + j;           SetSolidPenPat ((j * 3 div (i + 3) + i * w div 12) & 15);           Plot (i, k);           Plot (k, i);           temp  := size - i;           temp2 := size - k;           Plot (temp,  temp2);           Plot (temp2, temp);           Plot (k,     temp);           Plot (temp,  k);           Plot (i,     temp2);           Plot (temp2, i);           Stop (stopVar);           if stopVar.stopFlag then goto 1;           end;1:EndGraph;end. { KaleidoScope }