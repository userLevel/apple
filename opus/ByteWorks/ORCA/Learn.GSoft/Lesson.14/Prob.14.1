      REM Implement a binary search      CONST SIZE = 100:! size of the array      DIM A(SIZE) AS INTEGER :! array to search      ! fill the array      CALL FILL      ! test the Find procedure      CALL TEST      END      !----------------------------------------------------------      !      ! Fill - fill the array      !      ! Shared variables:      !    a - array to fill      !    size - size of the array      !      !----------------------------------------------------------      SUB FILL      SHARED A(), SIZE      DIM I AS INTEGER :! loop index      FOR I = 1 TO SIZE        A(I) = I * 2      NEXT      END SUB      !----------------------------------------------------------      !      ! Find - find the index of a matching array element      !      ! Shared variables:      !    a - array to fill      !    size - size of the array      !      ! Parameters:      !    value - value to find      !      ! Returns: The array index of the matching array value.      !    If there are no matching array values, a zero is      !    returned.      !               !----------------------------------------------------------      FUNCTION FIND(VALUE AS INTEGER ) AS INTEGER      SHARED A(), SIZE      DIM LEFT AS INTEGER , RIGHT AS INTEGER , MIDDLE AS INTEGER :! array indices      LEFT = 1      RIGHT = SIZE      DO        MIDDLE = (LEFT + RIGHT) / 2        IF VALUE < A(MIDDLE) THEN          RIGHT = MIDDLE - 1        ELSE          LEFT = MIDDLE + 1        END IF      LOOP UNTIL VALUE = A(MIDDLE) OR LEFT > RIGHT      IF VALUE = A(MIDDLE) THEN        FIND = MIDDLE      ELSE        FIND = 0      END IF      END FUNCTION      !----------------------------------------------------------      !      ! Test - test the find subroutine      !      ! Shared variables:      !    a - array to fill      !      !----------------------------------------------------------      SUB TEST      SHARED A()      DIM I AS INTEGER :! loop index      ! check to be sure each value can be found      FOR I = 1 TO SIZE        IF A(FIND(I * 2)) <> I * 2 THEN          PRINT "Failed to find ";I * 2        END IF      NEXT      ! check to be sure missing values are not found      IF FIND(0) <> 0 THEN        PRINT "Reported 'found' for Find(0)"      END IF      IF FIND(101) <> 0 THEN        PRINT "Reported 'found' for Find(101)"      END IF      IF FIND(202) <> 0 THEN        PRINT "Reported 'found' for Find(202)"      END IF      END SUB