      REM Create a binary tree from keyboard strings      ! tree entry      TYPE TREERECORD        LEFT AS POINTER TO TREERECORD        RIGHT AS POINTER TO TREERECORD        STR AS STRING      END TYPE      TYPE TREEPTR AS POINTER TO TREERECORD      DIM TREE AS TREEPTR:! top of the tree      DIM TPTR AS TREEPTR:! work pointer      DIM STR AS STRING :! work string      ! nothing in the tree      TREE = NIL      ! build the tree of strings      DO        ! get a string        LINE INPUT "String: ";STR        IF LEN (STR) <> 0 THEN          ! create a new record          ALLOCATE (TPTR)          IF TPTR <> NIL THEN            TPTR^.LEFT = NIL            TPTR^.RIGHT = NIL            TPTR^.STR = STR            ! add it to the tree            CALL ADD(TREE, TPTR)          END IF        END IF      LOOP UNTIL LEN (STR) = 0      ! search the tree      DO        ! get a string        LINE INPUT "String: ";STR        IF LEN (STR) <> 0 THEN          TPTR = SEARCH(TREE, STR)          PRINT STR;          IF TPTR = NIL THEN            PRINT " is not in the database."          ELSE            PRINT " is in the database."          END IF        END IF      LOOP UNTIL LEN (STR) = 0      ! dispose of the tree of string      IF TREE <> NIL THEN        CALL DISPOSETREE(TREE)      END IF      END      !----------------------------------------------------------      !      ! Add - add a record to the tree      !      ! Parameters:      !    tree - next node in the tree      !    rec - record to add to the tree      !      !----------------------------------------------------------      SUB ADD(TREE AS TREEPTR, REC AS TREEPTR)      IF TREE = NIL THEN        TREE = REC      ELSE IF REC^.STR < TREE^.STR THEN        CALL ADD(TREE^.LEFT, REC)      ELSE IF REC^.STR > TREE^.STR THEN        CALL ADD(TREE^.RIGHT, REC)      ELSE        DISPOSE (TREE)      END IF      END SUB      !----------------------------------------------------------      !      ! DisposeTree - dispose of the tree      !      ! Parameters:      !    tree - node to dispose of      !      !----------------------------------------------------------      SUB DISPOSETREE(TREE AS TREEPTR)      IF TREE^.RIGHT <> NIL THEN        CALL DISPOSETREE(TREE^.RIGHT)      END IF      IF TREE^.LEFT <> NIL THEN        CALL DISPOSETREE(TREE^.LEFT)      END IF      DISPOSE (TREE)      END SUB      !----------------------------------------------------------      !      ! Search - search the tree      !      ! Parameters:      !    tree - node to search      !    str - string to look for      !      !----------------------------------------------------------      FUNCTION SEARCH(TREE AS TREEPTR, STR AS STRING ) AS TREEPTR      IF TREE = NIL THEN        SEARCH = NIL      ELSE IF TREE^.STR > STR THEN        SEARCH = SEARCH(TREE^.LEFT, STR)      ELSE IF TREE^.STR < STR THEN        SEARCH = SEARCH(TREE^.RIGHT, STR)      ELSE        SEARCH = TREE      END IF      END FUNCTION