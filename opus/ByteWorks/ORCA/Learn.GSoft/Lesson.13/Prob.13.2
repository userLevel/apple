      REM Count the compares needed to sort a pseudo-random array with      REM a shell sort.      CONST TRIALS = 100:! number of trial runs      CONST SIZE = 2:! size of the array to sort      DIM COUNT AS INTEGER :! number of compares      DIM A(SIZE) AS INTEGER :! array to sort      DIM I AS INTEGER :! loop variable      ! no compares so far      COUNT = 0      ! do the trial runs      FOR I = 1 TO TRIALS        CALL FILL        CALL SORT      NEXT      PRINT USING "There average number of compares is ##.##.";COUNT / TRIALS      END      !----------------------------------------------------------      !      ! Fill - fill an array      !      ! Shared Variables      !    A - array to fill      !    size - number of elements to fill      !      !----------------------------------------------------------      SUB FILL      SHARED A(), SIZE      DIM I AS INTEGER :! loop variable      FOR I = 1 TO SIZE        A(I) = RANDOMVALUE((SIZE))      NEXT      END SUB      !----------------------------------------------------------      !      ! RandomValue - Return a random number in the range 1 to max      !      ! Parameters:      !    max - maximum allowed value for the random number      !      ! Returns: Random number in the range 1..max      !      !----------------------------------------------------------      FUNCTION RANDOMVALUE(MAX AS INTEGER ) AS INTEGER      DIM VALUE AS INTEGER :! Random value to return      VALUE = 1 + RND (1) * MAX      IF VALUE = MAX + 1 THEN        VALUE = MAX      END IF      RANDOMVALUE = VALUE      END FUNCTION      !----------------------------------------------------------      !      ! Sort - sort an array      !      ! Shared Variables      !    A - array to sort      !    count - number of swaps      !    size - number of elements to sort      !      !----------------------------------------------------------      SUB SORT      SHARED A(), COUNT, SIZE      DIM I AS INTEGER :! loop variable/array index      DIM SWAP AS BOOLEAN:! was a value swapped?      DIM TEMP AS INTEGER :! temp; used for swapping      DO        SWAP = FALSE        FOR I = 1 TO SIZE - 1          COUNT = COUNT + 1          IF A(I) > A(I + 1) THEN            TEMP = A(I)            A(I) = A(I + 1)            A(I + 1) = TEMP            SWAP = TRUE          END IF        NEXT      LOOP WHILE SWAP      END SUB