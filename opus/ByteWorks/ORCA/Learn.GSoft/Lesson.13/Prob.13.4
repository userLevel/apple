      REM A sample of quick sort.  This version counts the number      REM of times SORT is called.      CONST TRIALS = 100:! number of trial runs      CONST SIZE = 10      DIM COUNT AS INTEGER :! number of compares      DIM A(SIZE) AS INTEGER      ! do the trial runs      COUNT = 0      FOR I = 1 TO TRIALS        CALL FILL        CALL SORT(1, (SIZE))      NEXT      CALL PRINTARRAY      PRINT      PRINT USING "There average number of compares is ##.##.";COUNT / TRIALS      END      !----------------------------------------------------------      !      ! Fill - fill an array      !      ! Shared Variables      !    A - array to fill      !    size - number of elements to fill      !      !----------------------------------------------------------      SUB FILL      SHARED A(), SIZE      DIM I AS INTEGER :! loop variable      FOR I = 1 TO SIZE        A(I) = RANDOMVALUE((SIZE))      NEXT      END SUB      !----------------------------------------------------------      !      ! PrintArray - print the array      !      ! Shared Variables      !    A - array to sort      !    size - number of elements to print      !      !----------------------------------------------------------      SUB PRINTARRAY      SHARED A(), SIZE      DIM I AS INTEGER :! loop variable      FOR I = 1 TO SIZE        PRINT A(I)      NEXT      END SUB      !----------------------------------------------------------      !      ! RandomValue - Return a random number in the range 1 to max      !      ! Parameters:      !    max - maximum allowed value for the random number      !      ! Returns: Random number in the range 1..max      !      !----------------------------------------------------------      FUNCTION RANDOMVALUE(MAX AS INTEGER ) AS INTEGER      DIM VALUE AS INTEGER :! Random value to return      VALUE = 1 + RND (1) * MAX      IF VALUE = MAX + 1 THEN        VALUE = MAX      END IF      RANDOMVALUE = VALUE      END FUNCTION      !----------------------------------------------------------      !      ! Sort - sort an array      !      ! Shared Variables:      !    A - array to sort      !    count - number of compares      !      ! Parameters:      !    left, right - range of indecies to sort      !      !----------------------------------------------------------      SUB SORT(LEFT AS INTEGER , RIGHT AS INTEGER )      SHARED A(), COUNT      DIM I AS INTEGER , J AS INTEGER :! array indices      DIM PIVOT AS INTEGER :! pivot value      DIM TEMP AS INTEGER :! used to swap values      ! quit if there is only 1 element to sort      IF RIGHT > LEFT THEN        ! find the pivot index        I = (LEFT - 1) + (RIGHT - LEFT + 1) / 2        ! put the pivot at the end and save it for compares        PIVOT = A(I)        A(I) = A(RIGHT)        A(RIGHT) = PIVOT        ! set up the start indices        I = LEFT        J = RIGHT - 1        ! partition the array        WHILE I <> J          WHILE A(I) <= PIVOT AND I <> J            COUNT = COUNT + 1            I = I + 1          WEND          WHILE A(J) >= PIVOT AND I <> J            COUNT = COUNT + 1            J = J - 1          WEND          TEMP = A(I)          A(I) = A(J)          A(J) = TEMP        WEND        ! find the pivot insert point        COUNT = COUNT + 1        IF A(I) < PIVOT THEN          I = I + 1        END IF        ! replace the pivot        TEMP = A(I)        A(I) = A(RIGHT)        A(RIGHT) = TEMP        ! sort to the left of the pivot        CALL SORT(LEFT, I - 1)        ! sort to the right of the pivot        CALL SORT(I + 1, RIGHT)      END IF      END SUB