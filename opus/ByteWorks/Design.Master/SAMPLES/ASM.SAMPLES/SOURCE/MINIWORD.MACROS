 MACRO&LAB PH2 &N1 LCLC &C&LAB ANOP&C AMID &N1,1,1 AIF "&C"="#",.D AIF S:LONGA=1,.A REP #%00100000.A AIF "&C"<>"{",.B&C AMID &N1,L:&N1,1 AIF "&C"<>"}",.G&N1 AMID &N1,2,L:&N1-2 LDA (&N1) PHA AGO .E.B LDA &N1 PHA AGO .E.D&N1 AMID &N1,2,L:&N1-1 PEA &N1 AGO .F.E AIF S:LONGA=1,.F SEP #%00100000.F MEXIT.G MNOTE "Missing closing '}'",16 MEND MACRO&LAB PH4 &N1 LCLC &C&LAB ANOP&C AMID &N1,1,1 AIF "&C"="#",.D AIF S:LONGA=1,.A REP #%00100000.A AIF "&C"<>"{",.B&C AMID &N1,L:&N1,1 AIF "&C"<>"}",.G&N1 AMID &N1,2,L:&N1-2 LDY #2 LDA (&N1),Y PHA LDA (&N1) PHA AGO .E.B AIF "&C"<>"[",.C LDY #2 LDA &N1,Y PHA LDA &N1 PHA AGO .E.C LDA &N1+2 PHA LDA &N1 PHA AGO .E.D&N1 AMID &N1,2,L:&N1-1 PEA +(&N1)|-16 PEA &N1 AGO .F.E AIF S:LONGA=1,.F SEP #%00100000.F MEXIT.G MNOTE "Missing closing '}'",16 MEND MACRO&lab _SysFailMgr&lab ldx #$1503 jsl $E10000 MEND MACRO&lab _StartUpTools&lab ldx #$1801 jsl $E10000 MEND MACRO&lab _ShutDownTools&lab ldx #$1901 jsl $E10000 MEND MACRO&lab _DrawMenuBar&lab ldx #$2A0F jsl $E10000 MEND MACRO&lab _FixMenuBar&lab ldx #$130F jsl $E10000 MEND MACRO&lab _InsertMenu&lab ldx #$0D0F jsl $E10000 MEND MACRO&lab _NewMenu2&lab ldx #$3E0F jsl $E10000 MEND MACRO&lab _FixAppleMenu&lab ldx #$1E05 jsl $E10000 MEND MACRO&lab _InitCursor&lab ldx #$CA04 jsl $E10000 MEND MACRO&lab _TaskMaster&lab ldx #$1D0E jsl $E10000 MEND MACRO&lab _HiliteMenu&lab ldx #$2C0F jsl $E10000 MEND MACRO&lab _BeginUpdate&lab ldx #$1E0E jsl $E10000 MEND MACRO&lab _EndUpdate&lab ldx #$1F0E jsl $E10000 MEND MACRO&lab _DrawControls&lab ldx #$1010 jsl $E10000 MEND MACRO&lab _NewWindow&lab ldx #$090E jsl $E10000 MEND MACRO&lab _NewControl2&lab ldx #$3110 jsl $E10000 MEND MACRO&lab _DisableMItem&lab ldx #$310F jsl $E10000 MEND MACRO&lab _EnableMItem&lab ldx #$300F jsl $E10000 MEND MACRO&lab _CloseWindow&lab ldx #$0B0E jsl $E10000 MEND MACRO&lab _GetWRefCon&lab ldx #$290E jsl $E10000 MEND MACRO&lab _FrontWindow&lab ldx #$150E jsl $E10000 MEND MACRO&lab _CloseDialog&lab ldx #$0C15 jsl $E10000 MEND MACRO&lab _GetNewModalDialog&lab ldx #$3215 jsl $E10000 MEND MACRO&lab _ModalDialog&lab ldx #$0F15 jsl $E10000 MEND MACRO&lab _SFGetFile2&lab ldx #$0E17 jsl $E10000 MEND MACRO&LAB LONG &A,&B LCLB &I LCLB &M&A AMID &A,1,1&M SETB ("&A"="M").OR.("&A"="m")&I SETB ("&A"="I").OR.("&A"="i") AIF C:&B=0,.A&B AMID &B,1,1&M SETB ("&B"="M").OR.("&B"="m").OR.&M&I SETB ("&B"="I").OR.("&B"="i").OR.&I.A&LAB REP #&M*32+&I*16 AIF .NOT.&M,.B LONGA ON.B AIF .NOT.&I,.C LONGI ON.C MEND MACRO&LAB SHORT &A,&B LCLB &I LCLB &M&A AMID &A,1,1&M SETB ("&A"="M").OR.("&A"="m")&I SETB ("&A"="I").OR.("&A"="i") AIF C:&B=0,.A&B AMID &B,1,1&M SETB ("&B"="M").OR.("&B"="m").OR.&M&I SETB ("&B"="I").OR.("&B"="i").OR.&I.A&LAB SEP #&M*32+&I*16 AIF .NOT.&M,.B LONGA OFF.B AIF .NOT.&I,.C LONGI OFF.C MEND MACRO&lab _OpenGS &params&lab jsl $E100A8 dc i2"$2010" dc i4"&params" MEND MACRO&lab _TESetText&lab ldx #$0B22 jsl $E10000 MEND MACRO&lab _ReadGS &params&lab jsl $E100A8 dc i2"$2012" dc i4"&params" MEND MACRO&lab _NewHandle&lab ldx #$0902 jsl $E10000 MEND MACRO&lab _DisposeHandle&lab ldx #$1002 jsl $E10000 MEND MACRO&lab _CloseGS &params&lab jsl $E100A8 dc i2"$2014" dc i4"&params" MEND MACRO&lab _PrDefault&lab ldx #$0913 jsl $E10000 MEND MACRO&lab _PrStlDialog&lab ldx #$0B13 jsl $E10000 MEND MACRO&lab _PrCloseDoc&lab ldx #$0F13 jsl $E10000 MEND MACRO&lab _PrClosePage&lab ldx #$1113 jsl $E10000 MEND MACRO&lab _PrOpenDoc&lab ldx #$0E13 jsl $E10000 MEND MACRO&lab _PrOpenPage&lab ldx #$1013 jsl $E10000 MEND MACRO&lab _SetPort&lab ldx #$1B04 jsl $E10000 MEND MACRO&lab _PrJobDialog&lab ldx #$0C13 jsl $E10000 MEND MACRO&lab _SFPutFile2&lab ldx #$0F17 jsl $E10000 MEND MACRO&lab _WriteGS &params&lab jsl $E100A8 dc i2"$2013" dc i4"&params" MEND MACRO&lab _GetSysWFlag&lab ldx #$4C0E jsl $E10000 MEND MACRO&lab _TEPaintText&lab ldx #$1322 jsl $E10000 MEND MACRO&lab _MoveTo&lab ldx #$3A04 jsl $E10000 MEND MACRO&lab _PenNormal&lab ldx #$3604 jsl $E10000 MEND MACRO&LAB FI2DEC&LAB PEA $040B LDX #$090A JSL $E10000 MEND MACRO&lab _TEGetText&lab ldx #$0C22 jsl $E10000 MEND MACRO&lab _SetWTitle&lab ldx #$0D0E jsl $E10000 MEND MACRO&lab _CreateGS &params&lab jsl $E100A8 dc i2"$2001" dc i4"&params" MEND MACRO&lab _GetFileInfoGS &params&lab jsl $E100A8 dc i2"$2006" dc i4"&params" MEND MACRO&lab _DestroyGS &params&lab jsl $E100A8 dc i2"$2002" dc i4"&params" MEND MACRO&lab _Alert&lab ldx #$1715 jsl $E10000 MEND MACRO&lab _CautionAlert&lab ldx #$1A15 jsl $E10000 MEND MACRO&lab _NoteAlert&lab ldx #$1915 jsl $E10000 MEND MACRO&lab _StopAlert&lab ldx #$1815 jsl $E10000 MEND MACRO&lab _Int2Hex&lab ldx #$220B jsl $E10000 MEND MACRO&LAB JEQ &BP&LAB BNE *+5 BRL &BP MEND MACRO&lab _DisposeAll&lab ldx #$1102 jsl $E10000 MEND MACRO&LAB BGT &BP&LAB BEQ *+4 BGE &BP MEND MACRO&lab _PrPicFile&lab ldx #$1213 jsl $E10000 MEND MACRO&lab _Multiply&lab ldx #$090B jsl $E10000 MEND MACRO&lab _TEGetTextInfo&lab ldx #$0D22 jsl $E10000 MEND MACRO&LAB QUIT &DCB&LAB JSL $E100A8 DC I2'$29' DC I4'&DCB' MEND MACRO&lab _MaxBlock&lab ldx #$1C02 jsl $E10000 MEND MACRO&LAB CMP4 &N1,&N2 LCLB &YISTWO&LAB ~SETM ~LDA.H &N1 ~OP.H EOR,&N2 BPL ~A&SYSCNT ~LDA.H &N2 ~OP.H CMP,&N1 BRA ~B&SYSCNT~A&SYSCNT ~LDA.H &N1 ~OP.H CMP,&N2 BNE ~B&SYSCNT ~LDA &N1 ~OP CMP,&N2~B&SYSCNT ANOP ~RESTM MEND MACRO&LAB ~OP.H &OPC,&OP&LAB ANOP LCLC &C&C AMID "&OP",1,1 AIF "&C"="[",.B AIF "&C"<>"{",.D&C AMID "&OP",L:&OP,1 AIF "&C"="}",.A MNOTE "Missing closing '}'",2&OP SETC &OP}.A&OP AMID "&OP",2,L:&OP-2&OP SETC (&OP).B AIF &YISTWO,.C&YISTWO SETB 1 LDY #2&OP SETC "&OP,Y".C &OPC &OP MEXIT.D AIF "&C"<>"#",.E&OP AMID "&OP",2,L:&OP-1&OP SETC "#^&OP" &OPC &OP MEXIT.E &OPC 2+&OP MEND MACRO&LAB ~LDA.H &OP&LAB ANOP LCLC &C&C AMID "&OP",1,1 AIF "&C"="[",.B AIF "&C"<>"{",.D&C AMID "&OP",L:&OP,1 AIF "&C"="}",.A MNOTE "Missing closing '}'",2&OP SETC &OP}.A&OP AMID "&OP",2,L:&OP-2&OP SETC (&OP).B AIF &YISTWO,.C&YISTWO SETB 1 LDY #2&OP SETC "&OP,Y".C LDA &OP MEXIT.D AIF "&C"<>"#",.E&OP AMID "&OP",2,L:&OP-1&OP SETC "#^&OP" LDA &OP MEXIT.E LDA 2+&OP MEND MACRO&LAB ~SETM&LAB ANOP AIF C:&~LA,.B GBLB &~LA GBLB &~LI.B&~LA SETB S:LONGA&~LI SETB S:LONGI AIF S:LONGA.AND.S:LONGI,.A REP #32*(.NOT.&~LA)+16*(.NOT.&~LI) LONGA ON LONGI ON.A MEND MACRO&LAB ~RESTM&LAB ANOP AIF (&~LA+&~LI)=2,.I SEP #32*(.NOT.&~LA)+16*(.NOT.&~LI) AIF &~LA,.H LONGA OFF.H AIF &~LI,.I LONGI OFF.I MEND MACRO&LAB ~LDA &OP LCLC &C&C AMID "&OP",1,1 AIF "&C"<>"{",.B&C AMID "&OP",L:&OP,1 AIF "&C"="}",.A MNOTE "Missing closing '}'",2&OP SETC &OP}.A&OP AMID "&OP",2,L:&OP-2&OP SETC (&OP).B&LAB LDA &OP MEND MACRO&LAB ~OP &OPC,&OP LCLC &C&C AMID "&OP",1,1 AIF "&C"<>"{",.B&C AMID "&OP",L:&OP,1 AIF "&C"="}",.A MNOTE "Missing closing '}'",2&OP SETC &OP}.A&OP AMID "&OP",2,L:&OP-2&OP SETC (&OP).B&LAB &OPC &OP MEND MACRO&LAB DW &ADR&LAB DC I1"L:SYSA&SYSCNT"SYSA&SYSCNT DC C"&ADR" MEND