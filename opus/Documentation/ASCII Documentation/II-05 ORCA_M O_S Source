ORCA/M(tm)4.1 SourceSource for ORCA.SYSTEM, ORCA.HOST, the subroutine libraries and the XREF utility from theProDOS version of ORCA/M.(tm)By Mike Westerfield & Phil MontoyaCopyright 1987Limited Warranty - Subject to the below stated limitations, Byte Works Inc. hereby warrants that the programs contained in this unit will load and run on the standard manufacturer's configuration for the computer listed for a period of ninety (90) days from date of purchase. Except for such warranty, this product is supplied on an "as is" basis without warranty as to merchantability or its fitness for any particular purpose. The limits of warranty extend only to the original purchaser.Neither Byte Works Inc. nor the authors of this program are liable or responsible to the purchaser and/or user for loss or damage caused, or alleged to be caused, directly or indirectly by this software and its attendant documentation, including (but not limited to) interruption of service, loss of business, or anticipatory profits.To obtain the warranty offered, the enclosed purchaser registration card must be completed and returned to the Byte Works Inc. within ten (10) days of purchase.Important Notice - This is a fully copyrighted work and as such is protected under copyright laws of the United States of America. According to these laws, consumers of copywritten material may make copies for their personal use only. Duplication for any purpose whatsoever would constitute infringement of copyright laws and the offender would be liable to civil damages of up to $50,000 in addition to actual damages, plus criminal penalties of up to one year imprisonment and/or a $10,000 file.This product is sold for use on a single computer at a single location. Contact the publisher for information regarding licensing for use at multiple-workstation or multiple computer installations.Source code for all subroutine libraries, macros, and programs included in this package are copyrighted and may not be duplicated or redistributed under any circumstances without prior written permission of the publisher.Use of Libraries - The enclosed subroutine libraries are fully copyrighted works. It is the policy of Byte Works Inc. to license these libraries to purchasers of ORCA/M free of charge. Such licenses are generally restricted to include the libraries of binary files, and do not extend to use of the source code. A copy of the program, along with any documentation, and a list of the library subroutines used is required at the time of the licensing, and the document must give credit for using libraries from ORCA/M. For details, please contact the Byte Works Inc.ORCA/M is a trademark of the Byte Works, Inc. Apple is a registered trademark of Apple Computer, Inc.Program, Documentation and DesignCopyright 1984, 1985, 1986The Byte Works, Inc.OverviewORCA Source is a collection of source code for the operating system and subroutine libraries for the ProDOS 8 version of ORCA/M. In addition, the source code for the XREF global cross reference utility has been included.The reason for choosing to release only this source code is partly due to our perceptions of what you need, and partly tradition. The source code for the operating system and subroutine libraries has always been available for each version of ORCA/M. The operating system source is included to let you add drivers for unusual hardware, as well as to let you see the internal workings of the part of ORCA that your programs interface with if they run under ORCA, rather than under BASIC.SYSTEM or as their own system program.The subroutine library source is considered essential to the writing of efficient programs. To use the subroutine libraries with confidence, it is sometimes necessary to see exactly how they work. Then, too, bugs are not unheard of. If you have the source code to the libraries, it is easier for you to be sure that the bug is not in the libraries, or if it is, to fix it. Finally, it may be necessary to write a program for use on another computer, or for use in a ROM environment. The libraries are optimized for the Apple // RAM environment, and do not always work on other computers or in ROM. With the source code, you can make the necessary modifications.We felt that a concrete example of a working utility would help others write utilities that would work under ORCA. The XREF utility was chosen for several reasons. First, it uses all of the special features required to execute under ORCA, including reading the input line to find file names and switches and asking for a disk that is not on line at the time the program is executed. In addition, it is the only utility that may need to be modified by others, since a compiler executing under ORCA should be able to do cross references under ORCA.The remainder of the documentation explains, in a general way, what is on each of the disks. All of the programs are thoroughly documented with internal comments, so the internal workings of the code is not elaborated on here. All of the programs will assemble and execute under ORCA/M 4.1 with the standard macro and subroutine library package.Should you wish to use any of the subroutines or portions of code from this package in a commercial program, please contact us. Due to the structure of the copyright laws, we must require that all such uses be licensed. Licensing is free of charge; we simply ask that the source of the routines be acknowledged. We have not had any mason to refuse to grant a license to date.The Operating System/SOURCE1 has two subdirectories, one of which contains the source for ORCA.SYSTEM and the other the source for ORCA.HOST. ORCA.SYSTEM is the program that executes first as ORCA boots. It should be used to install non-standard drivers, such as clock-card drivers or peculiar disk drivers. Clock-card drivers are only needed if the clock card in use is not a standard ProDOS clock. They should be installed in page 3, which is not used by ORCA. Disk drivers must be installed outside of the memory range of $400 - $BFFF, which really only leaves page 2 of the RAM card. Note that although this area is reserved for future use by ProDOS, it is not currently used.ORCA.HOST is the resident part of the operating system. It occupies the space from $800 - $1FFF. In it are the drivers for eighty-column boards, special keyboard drivers, and printer drivers. In addition, ORCA.HOST serves as an overlay processor, spooling the various parts of ORCA and user programs in and out of memory. Hooks for EXEC files and 1/0 redirection are also included here.Console Drivers/SOURCE3 contains a subdirectory named DRIVERS which contains the files OH1, OH2, and OH3. OH1 is the source code for interfacing ORCA with a Videx Standard or Ultraterm. CRT card. OH2 is the source code for using ORCA with a Videx No-Inverse card. OH3 contains the code for a 40-column screen driver. All three of the files OH1, OH2, and OH3 are to be used with the files contained in the /SOURCE1 subdirectory named ORCA.HOST.GraphicsThe graphics subroutines are contained on /SOURCE2. COMMON is a file used by all of the subroutine libraries. It contains global equates, and serves as a dummy subroutine that will appear as the ROOT file. Since COMMON is never called, it is safe to delete the ROOT file after an assembly. If COMMON is changed, it should be changed for all of the subroutine libraries.Note that the graphics routines are set up to address any pixel-oriented graphics device that has a resolution of less than 32768 by 32768 with 16 colors. This means that the routines are not always as efficient as they could be for a specific graphics program. It also means that the system can be quickly adapted to other 6502 computers that offer pixel graphics.The NOTE macro calls a subroutine which is also contained in the graphics libraries.Integer Math/SOURCE3 contains the integer math libraries for two- and eight-byte integer math. The four-byte integer math subroutines are contained on /SOURCE2. All use COMMON, which is included on all four disks.Input and OutputThe remainder of the third disk is filled out with the input and output library. These routines also require support from the library on the next disk.MiscellaneousThe last disk, /SOURCE4, contains a collection of subroutines that did not fit into another category. Many are used by more than one of the previous libraries. Once again, COMMON is required, and is the same as for all of the other libraries.XREFThe source code for the cross reference utility is contained on a subdirectory on the last disk. It comes in two parts. The first part produces XREF, the main portion of the cross reference utility. Its source code is in the files that start with XR. This part of the program contains all of the language independent parts of the utility. The second half is contained in the files that start with U816. After assembly, the result should be renamed to be XREF.language, where language is the name of the language that it works on. All of the language-dependent parts of the program are here, including deciding if a symbol is being declared or used, and identifying APPEND and COPY directives. 'Me second part needs to be rewritten for each language added to ORCA.MON+ Symbolic Debugger43